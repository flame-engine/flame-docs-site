<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Collision detection &#8212; Flame</title>
  <!-- Stylesheets -->
  <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
  <link rel="stylesheet" type="text/css" href="../_static/basic.css" />
  <link rel="stylesheet" type="text/css" href="../_static/flutter_app.css" />
  <link rel="stylesheet" type="text/css" href="../_static/flames.css" />
  <!-- Scripts -->
  <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
  <script src="../_static/jquery.js"></script>
  <script src="../_static/underscore.js"></script>
  <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
  <script src="../_static/doctools.js"></script>
  <script src="../_static/flutter_app.js"></script>
  <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
  <script>mermaid.initialize({startOnLoad:true});</script>
  <script src="../_static/versions.js"></script>
  <!--script src="searchindex.js" defer></script-->
  <!-- Links -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:ital,wght@0,400;0,700;1,400;1,700&display=swap">
  <link rel="preload" as="font" type="font/woff2" crossorigin="" href="../_static/fontawesome/fa-brands-400.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin="" href="../_static/fontawesome/fa-solid-900.woff2">
  <link rel="stylesheet" href="../_static/fontawesome/all.min.css">
  <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <link rel="index" title="Index" href="../genindex.html" />
  <link rel="search" title="Search" href="../search.html" />
  <link rel="next" title="Effects" href="effects.html" />
  <link rel="prev" title="Supported Platforms" href="platforms.html" />
</head>

<body data-spy="scroll" data-target="#toc-local" data-offset="80">

<div class="top-bar">
  <button id="menu-button" class="btn" title="Toggle menu"><i class="fa fa-bars"></i></button>
  <script type="text/javascript">
    jQuery(function(){
      $("#menu-button").click(function() {
        $(this).toggleClass("active");
        $(".sidebar-left-area").toggleClass("active");
      });
    });
  </script>

  <a href="../index.html" class="logo_image">
    <img src="../_static/logo_flame.png">
  </a>

  <div class="highlight-box" role="alert" style="display:none">
    <div>
      <div class="title">highlighted:</div>
      <div class="content" id="highlight-content"></div>
    </div>
    <button type="button" class="close" data-dismiss="alert" aria-label="Dismiss">×</button>
  </div>
  <div class="expander"></div>

  <div class="versions-placeholder"></div>
  <a href="https://discord.com/channels/509714518008528896/516639688581316629" id="discord-button"
     class="btn" title="Flame Discord channel">
    <i class="fab fa-discord"></i>
  </a>
  <a href="https://github.com/flame-engine/flame/" id="github-button" class="btn"
     title="GitHub repository">
    <i class="fab fa-github"></i>
  </a>
</div>

<div class="sidebar-left-area">
  <div class="sidebar-left-bg"></div>
  <div class="sidebar-left">
    <div class="searchbox" role="search">
      <form id="search-form" action="../search.html" method="get">
        <i class="icon fa fa-search"></i>
        <input type="search" class="form-control" id="search-input" name="q"
               placeholder="Search the docs..." autocomplete="off" />
      </form>
    </div>
    <div class="nav-left" role="navigation" aria-label="Main">
      <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="flame.html">flame</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="structure.html">File structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="game.html">Game loop</a></li>
<li class="toctree-l2"><a class="reference internal" href="components.html">Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="platforms.html">Platforms</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Collision detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="effects.html">Effects</a></li>
<li class="toctree-l2"><a class="reference internal" href="camera_and_viewport.html">Camera &amp; Viewport</a></li>
<li class="toctree-l2"><a class="reference internal" href="camera_component.html">Camera component</a></li>
<li class="toctree-l2"><a class="reference internal" href="inputs/inputs.html">Inputs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="inputs/gesture-input.html">Gesture input</a></li>
<li class="toctree-l3"><a class="reference internal" href="inputs/keyboard-input.html">Keyboard input</a></li>
<li class="toctree-l3"><a class="reference internal" href="inputs/other-inputs.html">Other inputs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="rendering/rendering.html">Rendering</a><ul>
<li class="toctree-l3"><a class="reference internal" href="rendering/images.html">Images, sprites and animations</a></li>
<li class="toctree-l3"><a class="reference internal" href="rendering/text.html">Text rendering</a></li>
<li class="toctree-l3"><a class="reference internal" href="rendering/palette.html">Colors and palette</a></li>
<li class="toctree-l3"><a class="reference internal" href="rendering/particles.html">Particles</a></li>
<li class="toctree-l3"><a class="reference internal" href="rendering/layers.html">Layers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="other/other.html">Other</a><ul>
<li class="toctree-l3"><a class="reference internal" href="other/debug.html">Debugging</a></li>
<li class="toctree-l3"><a class="reference internal" href="other/util.html">Utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="other/widgets.html">Widgets</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../flame_audio/flame_audio.html">flame_audio</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../flame_audio/audio.html">General audio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../flame_audio/bgm.html">Background music</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/tutorials.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/bare_flame_game.html">Bare Flame game</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/klondike/klondike.html">Klondike</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/klondike/step1.html">1. Preparation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/klondike/step2.html">2. Scaffolding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/klondike/step3.html">3. Cards</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/klondike/tbc.html">[To be continued]...</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../other_modules/other_modules.html">Other Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../other_modules/forge2d.html">Forge2D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../other_modules/oxygen.html">Oxygen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../other_modules/tiled.html">Tiled</a></li>
<li class="toctree-l2"><a class="reference internal" href="../other_modules/splash_screen.html">Splash screen</a></li>
</ul>
</li>
</ul>

    </div>
  </div>
</div>

<div class="main-area">
  <div class="document-wrapper">
    <div class="document" role="main">
      
  <section class="tex2jax_ignore mathjax_ignore" id="collision-detection">
<h1>Collision detection<a class="headerlink" href="#collision-detection" title="Permalink to this heading">¶</a></h1>
<p>Collision detection is needed in most games to detect and act upon two components intersecting each
other. For example an arrow hitting an enemy or the player picking up a coin.</p>
<p>In most collision detection systems you use something called hitboxes to create more precise
bounding boxes of your components. In Flame the hitboxes are areas of the component that can react
to collisions (and make <a class="reference internal" href="inputs/gesture-input.html#gesturehitboxes"><span class="std std-doc">gesture input</span></a>) more accurate.</p>
<p>The collision detection system supports three different types of shapes that you can build hitboxes
from, these shapes are Polygon, Rectangle and Circle. Multiple hitbox can be added to a component to
form the area which can be used to either detect collisions or whether it contains a point or not,
the latter is very useful for accurate gesture detection. The collision detection does not handle
what should happen when two hitboxes collide, so it is up to the user to implement what will happen
when for example two <code class="docutils literal notranslate"><span class="pre">PositionComponent</span></code>s have intersecting hitboxes.</p>
<p>Do note that the built-in collision detection system does not take collisions between two hitboxes
that overshoot each other into account, this could happen when they either move very fast or
<code class="docutils literal notranslate"><span class="pre">update</span></code> being called with a large delta time (for example if your app is not in the foreground).
This behaviour is called tunneling, if you want to read more about it.</p>
<p>Also note that the collision detection system has a limitation that makes it not work properly if
you have certain types of combinations of flips and scales of the ancestors of the hitboxes.</p>
<section id="mixins">
<h2>Mixins<a class="headerlink" href="#mixins" title="Permalink to this heading">¶</a></h2>
<section id="hascollisiondetection">
<h3>HasCollisionDetection<a class="headerlink" href="#hascollisiondetection" title="Permalink to this heading">¶</a></h3>
<p>If you want to use collision detection in your game you have to add the <code class="docutils literal notranslate"><span class="pre">HasCollisionDetection</span></code>
mixin to your game so that it can keep track of the components that can collide.</p>
<p>Example:</p>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">MyGame</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">FlameGame</span><span class="w"> </span><span class="kd">with</span><span class="w"> </span><span class="n">HasCollisionDetection</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="c1">// ...</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Now when you add <code class="docutils literal notranslate"><span class="pre">ShapeHitbox</span></code>s to components that are then added to the game, they will
automatically be checked for collisions.</p>
</section>
<section id="collisioncallbacks">
<h3>CollisionCallbacks<a class="headerlink" href="#collisioncallbacks" title="Permalink to this heading">¶</a></h3>
<p>To react to a collision you should add the <code class="docutils literal notranslate"><span class="pre">CollisionCallbacks</span></code> mixin to your component.
Example:</p>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">MyCollidable</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">PositionComponent</span><span class="w"> </span><span class="kd">with</span><span class="w"> </span><span class="n">CollisionCallbacks</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nd">@override</span><span class="w"></span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">onCollision</span><span class="p">(</span><span class="n">Set</span><span class="o">&lt;</span><span class="n">Vector2</span><span class="o">&gt;</span><span class="w"> </span><span class="n">points</span><span class="p">,</span><span class="w"> </span><span class="n">PositionComponent</span><span class="w"> </span><span class="n">other</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">other</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">ScreenHitbox</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="c1">//...</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">other</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">YourOtherComponent</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="c1">//...</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="nd">@override</span><span class="w"></span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">onCollisionEnd</span><span class="p">(</span><span class="n">PositionComponent</span><span class="w"> </span><span class="n">other</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">other</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">ScreenHitbox</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="c1">//...</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">other</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">YourOtherComponent</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="c1">//...</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>In this example we use Dart’s <code class="docutils literal notranslate"><span class="pre">is</span></code> keyword to check what kind of component we collided with. The set
of points is where the edges of the hitboxes intersect.</p>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">onCollision</span></code> method will be called on both <code class="docutils literal notranslate"><span class="pre">PositionComponent</span></code>s if they have both
implemented the <code class="docutils literal notranslate"><span class="pre">onCollision</span></code> method, and also on both hitboxes. The same goes for the
<code class="docutils literal notranslate"><span class="pre">onCollisionStart</span></code> and <code class="docutils literal notranslate"><span class="pre">onCollisionEnd</span></code> methods, which are called when two components and hitboxes
starts or stops colliding with each other.</p>
<p>When a <code class="docutils literal notranslate"><span class="pre">PositionComponent</span></code> (and hitbox) starts to collide with another <code class="docutils literal notranslate"><span class="pre">PositionComponent</span></code>
both <code class="docutils literal notranslate"><span class="pre">onCollisionStart</span></code> and <code class="docutils literal notranslate"><span class="pre">onCollision</span></code> are called, so if you don’t need to do something specific
when a collision starts you only need to override <code class="docutils literal notranslate"><span class="pre">onCollision</span></code>, and vice versa.</p>
<p>If you want to check collisions with the screen edges, as we do in the example above, you can use
the predefined <a class="reference internal" href="#screenhitbox"><span class="std std-doc">ScreenHitbox</span></a> class.</p>
</section>
</section>
<section id="shapehitbox">
<h2>ShapeHitbox<a class="headerlink" href="#shapehitbox" title="Permalink to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">ShapeHitbox</span></code>s are normal components, so you add them to the component that you want to add
hitboxes to just like any other component:</p>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">MyComponent</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">PositionComponent</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">onLoad</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">add</span><span class="p">(</span><span class="n">RectangleHitbox</span><span class="p">());</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>If you don’t add any arguments to the hitbox, like above, the hitbox will try to fill its parent as
much as possible. Except for having the hitboxes trying to fill their parents, there are two ways to
initiate hitboxes and it is with the normal constructor where you define the hitbox by itself, with
a size and a position etc. The other way is to use the <code class="docutils literal notranslate"><span class="pre">relative</span></code> constructor which defines the
hitbox in relation to the size of its intended parent.</p>
<p>You can read more about how the different shapes are defined in the
<a class="reference internal" href="components.html#shapecomponents"><span class="std std-doc">ShapeComponents</span></a> section.</p>
<p>Remember that you can add as many <code class="docutils literal notranslate"><span class="pre">ShapeHitbox</span></code>s as you want to your <code class="docutils literal notranslate"><span class="pre">PositionComponent</span></code> to make up
more complex areas. For example a snowman with a hat could be represented by three <code class="docutils literal notranslate"><span class="pre">CircleHitbox</span></code>s
and two <code class="docutils literal notranslate"><span class="pre">RectangleHitbox</span></code>s as its hat.</p>
<p>A hitbox can be used either for collision detection or for making gesture detection more accurate
on top of components, see more regarding the latter in the section about the
<a class="reference internal" href="inputs/gesture-input.html#gesturehitboxes"><span class="std std-doc">GestureHitboxes</span></a> mixin.</p>
<section id="collisiontype">
<h3>CollisionType<a class="headerlink" href="#collisiontype" title="Permalink to this heading">¶</a></h3>
<p>The hitboxes have a field called <code class="docutils literal notranslate"><span class="pre">collisionType</span></code> which defines when a hitbox should collide with
another. Usually you want to set as many hitboxes as possible to <code class="docutils literal notranslate"><span class="pre">CollisionType.passive</span></code> to make
the collision detection more performant. By default the <code class="docutils literal notranslate"><span class="pre">CollisionType</span></code> is <code class="docutils literal notranslate"><span class="pre">active</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">CollisionType</span></code> enum contains the following values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">active</span></code> collides with other <code class="docutils literal notranslate"><span class="pre">Collidable</span></code>s of type active or passive</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">passive</span></code> collides with other <code class="docutils literal notranslate"><span class="pre">Collidable</span></code>s of type active</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inactive</span></code> will not collide with any other <code class="docutils literal notranslate"><span class="pre">Collidable</span></code>s</p></li>
</ul>
<p>So if you have hitboxes that you don’t need to check collisions against each other you can mark
them as passive by setting <code class="docutils literal notranslate"><span class="pre">collisionType</span> <span class="pre">=</span> <span class="pre">CollisionType.passive</span></code>, this could for example be
ground components or maybe your enemies don’t need to check collisions between each other, then they
could be marked as <code class="docutils literal notranslate"><span class="pre">passive</span></code> too.</p>
<p>Imagine a game where there are a lot of bullets, that can’t collide with each other, flying towards
the player, then the player would be set to <code class="docutils literal notranslate"><span class="pre">CollisionType.active</span></code> and the bullets would be set to
<code class="docutils literal notranslate"><span class="pre">CollisionType.passive</span></code>.</p>
<p>Then we have the <code class="docutils literal notranslate"><span class="pre">inactive</span></code> type which simply doesn’t get checked at all in the collision detection.
This could be used for example if you have components outside of the screen that you don’t care
about at the moment but that might later come back in to view so they are not completely removed
from the game.</p>
<p>These are just examples of how you could use these types, there will be a lot more use cases for
them so don’t doubt to use them even if your use case isn’t listed here.</p>
</section>
<section id="polygonhitbox">
<h3>PolygonHitbox<a class="headerlink" href="#polygonhitbox" title="Permalink to this heading">¶</a></h3>
<p>It should be noted that if you want to use collision detection or <code class="docutils literal notranslate"><span class="pre">containsPoint</span></code> on the <code class="docutils literal notranslate"><span class="pre">Polygon</span></code>,
the polygon needs to be convex. So always use convex polygons or you will most likely run into
problems if you don’t really know what you are doing. It should also be noted that you should always
define the vertices in your polygon in a counter-clockwise order.</p>
<p>The other hitbox shapes don’t have any mandatory constructor, that is because they can have a
default calculated from the size of the collidable that they are attached to, but since a
polygon can be made in an infinite number of ways inside of a bounding box you have to add the
definition in the constructor for this shape.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">PolygonHitbox</span></code> has the same constructors as the <a class="reference internal" href="components.html#polygoncomponent"><span class="std std-doc">PolygonComponent</span></a>, see that
section for documentation regarding those.</p>
</section>
<section id="rectanglehitbox">
<h3>RectangleHitbox<a class="headerlink" href="#rectanglehitbox" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">RectangleHitbox</span></code> has the same constructors as the <a class="reference internal" href="components.html#rectanglecomponent"><span class="std std-doc">RectangleComponent</span></a>, see
that section for documentation regarding those.</p>
</section>
<section id="circlehitbox">
<h3>CircleHitbox<a class="headerlink" href="#circlehitbox" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">CircleHitbox</span></code> has the same constructors as the <a class="reference internal" href="components.html#circlecomponent"><span class="std std-doc">CircleComponent</span></a>, see that
section for documentation regarding those.</p>
</section>
</section>
<section id="screenhitbox">
<h2>ScreenHitbox<a class="headerlink" href="#screenhitbox" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">ScreenHitbox</span></code> is a component which represents the edges of your viewport/screen. If you add a
<code class="docutils literal notranslate"><span class="pre">ScreenHitbox</span></code> to your game your other components with hitboxes will be notified when they
collide with the edges. It doesn’t take any arguments, it only depends on the <code class="docutils literal notranslate"><span class="pre">size</span></code> of the game
that it is added to. To add it you can just do <code class="docutils literal notranslate"><span class="pre">add(ScreenHitbox())</span></code> in your game, if you don’t
want the <code class="docutils literal notranslate"><span class="pre">ScreenHitbox</span></code> itself to be notified when something collides with it. Since
<code class="docutils literal notranslate"><span class="pre">ScreenHitbox</span></code> has the <code class="docutils literal notranslate"><span class="pre">CollisionCallbacks</span></code> mixin you can add your own <code class="docutils literal notranslate"><span class="pre">onCollisionCallback</span></code>,
<code class="docutils literal notranslate"><span class="pre">onStartCollisionCallback</span></code> and <code class="docutils literal notranslate"><span class="pre">onEndCollisionCallback</span></code> functions to that object if needed.</p>
</section>
<section id="compositehitbox">
<h2>CompositeHitbox<a class="headerlink" href="#compositehitbox" title="Permalink to this heading">¶</a></h2>
<p>In the <code class="docutils literal notranslate"><span class="pre">CompositeHitbox</span></code> you can add multiple hitboxes so that they emulate being one joined hitbox.</p>
<p>If you want to form a hat for example you might want to use two <a class="reference internal" href="#rectanglehitbox"><span class="std std-doc">RectangleHitbox</span></a>s to follow that
hat’s edges properly, then you can add those hitboxes to an instance of this class and react to
collisions to the whole hat, instead of for just each hitbox separately.</p>
</section>
<section id="broad-phase">
<h2>Broad phase<a class="headerlink" href="#broad-phase" title="Permalink to this heading">¶</a></h2>
<p>Usually you don’t have to worry about the broad phase system that is used, so if the standard
implementation is performant enough for you, you probably don’t have to read this section.</p>
<p>A broad phase is the first step of collision detection where potential collisions are calculated.
To calculate these potential collisions are a lot cheaper to calculate than to check the exact
intersections from the directly and it removes the need to check all hitboxes against each other
and therefore avoiding O(n²). The broad phase produces a set of potential collisions (a set of
<code class="docutils literal notranslate"><span class="pre">CollisionProspect</span></code>s), this set is then used to check the exact intersections between hitboxes, this
is sometimes called narrow phase.</p>
<p>By default Flame’s collision detection is using a sweep and prune broadphase step, if your game
requires another type of broadphase you can write your own broadphase by extending <code class="docutils literal notranslate"><span class="pre">Broadphase</span></code> and
manually setting the collision detection system that should be used.</p>
<p>For example if you have implemented a broadphase built on a quad tree instead of the standard
sweep and prune, then you would do the following:</p>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">MyGame</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">FlameGame</span><span class="w"> </span><span class="kd">with</span><span class="w"> </span><span class="n">HasCollisionDetection</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">MyGame</span><span class="p">()</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">collisionDetection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">        </span><span class="n">StandardCollisionDetection</span><span class="p">(</span><span class="nl">broadphase:</span><span class="w"> </span><span class="n">QuadTreeBroadphase</span><span class="p">());</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="comparison-to-forge2d">
<h2>Comparison to Forge2D<a class="headerlink" href="#comparison-to-forge2d" title="Permalink to this heading">¶</a></h2>
<p>If you want to have a full-blown physics engine in your game we recommend that you use
Forge2D by adding <a class="reference external" href="https://github.com/flame-engine/flame_forge2d">flame_forge2d</a> as a dependency.
But if you have a simpler use-case and just want to check for collisions of components and improve
the accuracy of gestures, Flame’s built-in collision detection will serve you very well.</p>
<p>If you have the following needs you should at least consider to use
<a class="reference external" href="https://github.com/flame-engine/forge2d">Forge2D</a>:</p>
<ul class="simple">
<li><p>Interacting realistic forces</p></li>
<li><p>Particle systems that can interact with other bodies</p></li>
<li><p>Joints between bodies</p></li>
</ul>
<p>It is a good idea to just use the Flame collision detection system if you on the other hand only
need some of the following things (since it is simpler to not involve Forge2D):</p>
<ul class="simple">
<li><p>The ability to act on some of your components colliding</p></li>
<li><p>The ability to act on your components colliding with the screen boundaries</p></li>
<li><p>Complex shapes to act as a hitbox for your component so that gestures will be more accurate</p></li>
<li><p>Hitboxes that can tell what part of a component that collided with something</p></li>
</ul>
</section>
<section id="migration-from-the-collision-detection-system-in-v1-0">
<h2>Migration from the collision detection system in v1.0<a class="headerlink" href="#migration-from-the-collision-detection-system-in-v1-0" title="Permalink to this heading">¶</a></h2>
<p>The collision detection system introduced in v1.1 is easier to use, and much more efficient than the
one that was in v1.0, but while making these improvements some breaking changes had to be made.</p>
<p>There is no longer a <code class="docutils literal notranslate"><span class="pre">Collidable</span></code> mixin, instead your game automatically knows when a hitbox has
been added to one of your components when the <code class="docutils literal notranslate"><span class="pre">HasCollisionDetection</span></code> mixin is added to your game.</p>
<p>To receive the callbacks from collisions that your component is involved in you should add the
<code class="docutils literal notranslate"><span class="pre">CollisionCallbacks</span></code> mixin to your component, and then override the same methods as you did
previously.</p>
<p>Since the hitboxes now are <code class="docutils literal notranslate"><span class="pre">Component</span></code>s you add them to your component with <code class="docutils literal notranslate"><span class="pre">add</span></code> instead of
<code class="docutils literal notranslate"><span class="pre">addHitbox</span></code> which was used previously.</p>
<section id="name-changes">
<h3>Name changes<a class="headerlink" href="#name-changes" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ScreenCollidable</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">ScreenHitbox</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">HitboxCircle</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">CircleHitbox</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">HitboxRectangle</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">RectangleHitbox</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">HitboxPolygon</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">PolygonHitbox</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Collidable</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">CollisionCallbacks</span></code> (Only needed when you want to receive the callbacks)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">HasHitboxes</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">GestureHitboxes</span></code> (Only when you need hitboxes for gestures)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CollidableType</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">CollisionType</span></code></p></li>
</ul>
</section>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://examples.flame-engine.org/#/Collision%20Detection_Circles">https://examples.flame-engine.org/#/Collision Detection_Circles</a></p></li>
<li><p><a class="reference external" href="https://examples.flame-engine.org/#/Collision%20Detection_Multiple%20shapes">https://examples.flame-engine.org/#/Collision Detection_Multiple shapes</a></p></li>
<li><p><a class="reference external" href="https://examples.flame-engine.org/#/Collision%20Detection_Shapes%20without%20components">https://examples.flame-engine.org/#/Collision Detection_Shapes without components</a></p></li>
<li><p><a class="reference external" href="https://github.com/flame-engine/flame/tree/main/examples/lib/stories/collision_detection">https://github.com/flame-engine/flame/tree/main/examples/lib/stories/collision_detection</a></p></li>
</ul>
</section>
</section>


    </div>
    <div class="copyright">
      The content on this page is licensed under the <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 License</a>,
      and code samples under the <a href="https://raw.githubusercontent.com/flame-engine/flame/main/LICENSE">MIT License</a>.
    </div>
    <div class="prev-next-area">
      <a class="left-prev" id="prev-link" href="platforms.html" title="previous page">
        <i class="fa fa-angle-left"></i>
        <div class="prev-next-info">
          <p class="prev-next-subtitle">Previous:</p>
          <p class="prev-next-title">Supported Platforms</p>
        </div>
      </a>
      <div class='expander'></div>
      <a class="right-next" id="next-link" href="effects.html" title="next page">
        <div class="prev-next-info">
          <p class="prev-next-subtitle">Next:</p>
          <p class="prev-next-title">Effects</p>
        </div>
        <i class="fa fa-angle-right"></i>
      </a>
    </div>
  </div>

  <div class="sidebar-right">
    
    <div class="nav-right" role="navigation" aria-label="table of contents">
      <div id='toc-local' class='list-group'>
 <div class='header'><i class='fa fa-list'></i> Contents</div>
  <a href='#mixins' class='list-group-item level-1'>Mixins</a>
  <a href='#hascollisiondetection' class='list-group-item level-2'>HasCollisionDetection</a>
  <a href='#collisioncallbacks' class='list-group-item level-2'>CollisionCallbacks</a>
  <a href='#shapehitbox' class='list-group-item level-1'>ShapeHitbox</a>
  <a href='#collisiontype' class='list-group-item level-2'>CollisionType</a>
  <a href='#polygonhitbox' class='list-group-item level-2'>PolygonHitbox</a>
  <a href='#rectanglehitbox' class='list-group-item level-2'>RectangleHitbox</a>
  <a href='#circlehitbox' class='list-group-item level-2'>CircleHitbox</a>
  <a href='#screenhitbox' class='list-group-item level-1'>ScreenHitbox</a>
  <a href='#compositehitbox' class='list-group-item level-1'>CompositeHitbox</a>
  <a href='#broad-phase' class='list-group-item level-1'>Broad phase</a>
  <a href='#comparison-to-forge2d' class='list-group-item level-1'>Comparison to Forge2D</a>
  <a href='#migration-from-the-collision-detection-system-in-v1-0' class='list-group-item level-1'>Migration from the collision detection system in v1.0</a>
  <a href='#name-changes' class='list-group-item level-2'>Name changes</a>
  <a href='#examples' class='list-group-item level-1'>Examples</a>
</div>

    </div>
  </div>

  <div class="expander"></div>
</div>




</body>
</html>