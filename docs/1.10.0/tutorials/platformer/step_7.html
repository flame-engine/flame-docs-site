<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>7. Adding Menus &#8212; Flame</title>
  <!-- Stylesheets -->
  <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b20cc3f5" />
  <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=eeb27264" />
  <link rel="stylesheet" type="text/css" href="../../_static/dart_domain.css" />
  <link rel="stylesheet" type="text/css" href="../../_static/flutter_app.css?v=6984c178" />
  <link rel="stylesheet" type="text/css" href="../../_static/package.css?v=7889e545" />
  <link rel="stylesheet" type="text/css" href="../../_static/yarn_lexer.css?v=932ca0ec" />
  <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
  <link rel="stylesheet" type="text/css" href="../../_static/flames.css?v=37920019" />
  <link rel="stylesheet" type="text/css" href="../../_static/copy-button.css?v=deecb4da" />
  <!-- Scripts -->
  <script src="../../_static/jquery.js?v=5d32c60e"></script>
  <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
  <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
  <script src="../../_static/doctools.js?v=0b60eaae"></script>
  <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
  <script src="../../_static/flutter_app.js?v=3619378f"></script>
  <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
  <script src="../../_static/copybutton.js?v=f281be69"></script>
  <script src="../../_static/versions.js?v=58484017"></script>
  <script src="../../_static/menu-expand.js?v=8e297497"></script>
  <!--script src="searchindex.js" defer></script-->
  <!-- Links -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:ital,wght@0,400;0,700;1,400;1,700&display=swap">
  <link rel="preload" as="font" type="font/woff2" crossorigin="" href="../../_static/fontawesome/fa-brands-400.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin="" href="../../_static/fontawesome/fa-solid-900.woff2">
  <link rel="stylesheet" href="../../_static/fontawesome/all.min.css">
  <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  <link rel="index" title="Index" href="../../genindex.html" />
  <link rel="search" title="Search" href="../../search.html" />
  <link rel="next" title="Space Shooter Game Tutorial" href="../space_shooter/space_shooter.html" />
  <link rel="prev" title="6. Adding the HUD" href="step_6.html" />
</head>

<body data-spy="scroll" data-target="#toc-local" data-offset="80">

<div class="top-bar">
  <button id="menu-button" class="btn" title="Toggle menu"><i class="fa fa-bars"></i></button>
  <script type="text/javascript">
    jQuery(function(){
      $("#menu-button").click(function() {
        $(this).toggleClass("active");
        $(".sidebar-left-area").toggleClass("active");
      });

      $('div.nav-left li > a:not(:only-child)').wrap('<div class=submenu></div>');
      $('div.nav-left div.submenu').prepend('<a class=arrow>&nbsp;</a>');
      $('div.nav-left div.submenu > a.arrow')
        .click(function() {
          $(this.parentElement.parentElement).toggleClass('current');
        });

      // This function ensures that when navigating to internal targets within the page (such as
      // a section header), those targets will be visible to the user and not obscured by the menu
      // bar at the top of the page.
      function scrollToHashTarget() {
        if (location.hash !== location.oldHash) {
          window.scrollBy(0, -60);
          location.oldHash = location.hash;
        }
      }
      window.location.oldHash = '';
      window.addEventListener('hashchange', scrollToHashTarget);
      scrollToHashTarget();
    });
  </script>

  <a href="../../index.html" class="logo_image">
    <img src="../../_static/logo_flame.png">
  </a>  
  <div class="highlight-box" role="alert" style="display:none">
    <div>
      <div class="title">highlighted:</div>
      <div class="content" id="highlight-content"></div>
    </div>
    <button type="button" class="close" data-dismiss="alert" aria-label="Dismiss">Ã—</button>
  </div>
  <div class="expander"></div>

  <div class="versions-placeholder"></div>
  <a href="https://discord.com/invite/pxrBmy4" id="discord-button" class="btn"
     title="Blue Fire Discord server">
    <i class="fab fa-discord"></i>
  </a>
  <a href="https://github.com/flame-engine/flame/" id="github-button" class="btn"
     title="GitHub repository">
    <i class="fab fa-github"></i>
  </a>
</div>

<div class="sidebar-left-area">
  <div class="sidebar-left-bg"></div>
  <div class="sidebar-left">
    <div class="searchbox" role="search">
      <form id="search-form" action="../../search.html" method="get">
        <i class="icon fa fa-search"></i>
        <input type="search" class="form-control" id="search-input" name="q"
               placeholder="Search the docs..." autocomplete="off" />
      </form>
    </div>
    <div class="nav-left" role="navigation" aria-label="Main">
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../flame/flame.html">Flame</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../flame/structure.html">File Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../flame/game_widget.html">Game Widget</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../flame/game.html">Game Loop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../flame/components.html">Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../flame/router.html">Router</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../flame/platforms.html">Platforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../flame/collision_detection.html">Collision Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../flame/effects.html">Effects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../flame/camera_component.html">Camera Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../flame/inputs/inputs.html">Inputs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../flame/inputs/drag_events.html">Drag Events</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../flame/inputs/gesture_input.html">Gesture Input</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../flame/inputs/keyboard_input.html">Keyboard Input</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../flame/inputs/other_inputs.html">Other Inputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../flame/inputs/tap_events.html">Tap Events</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../flame/inputs/hardware_keyboard_detector.html">HardwareKeyboardDetector</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../flame/rendering/rendering.html">Rendering</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../flame/rendering/palette.html">Colors and Palette</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../flame/rendering/decorators.html">Decorators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../flame/rendering/images.html">Images, Sprites and Animations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../flame/rendering/layers.html">Layers and Snapshots</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../flame/rendering/particles.html">Particles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../flame/rendering/text_rendering.html">Text Rendering</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../flame/layout/layout.html">Layout</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../flame/layout/align_component.html">AlignComponent</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../flame/overlays.html">Overlays</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../flame/other/other.html">Other</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../flame/other/debug.html">Debugging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../flame/other/util.html">Utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../flame/other/widgets.html">Widgets</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../bridge_packages/bridge_packages.html">Bridge Packages</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../bridge_packages/flame_audio/flame_audio.html">flame_audio</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../bridge_packages/flame_audio/audio.html">General audio</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../bridge_packages/flame_audio/bgm.html">Background music</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../bridge_packages/flame_audio/audio_pool.html">AudioPool</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../bridge_packages/flame_bloc/flame_bloc.html">flame_bloc</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../bridge_packages/flame_bloc/bloc.html">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../bridge_packages/flame_bloc/bloc_components.html">Components</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../bridge_packages/flame_fire_atlas/flame_fire_atlas.html">flame_fire_atlas</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../bridge_packages/flame_fire_atlas/fire_atlas.html">Overview</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../bridge_packages/flame_forge2d/flame_forge2d.html">flame_forge2d</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../bridge_packages/flame_forge2d/forge2d.html">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../bridge_packages/flame_forge2d/joints.html">Joints</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../bridge_packages/flame_isolate/flame_isolate.html">flame_isolate</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../bridge_packages/flame_isolate/isolate.html">Overview</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../bridge_packages/flame_lottie/flame_lottie.html">flame_lottie</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../bridge_packages/flame_network_assets/flame_network_assets.html">flame_network_assets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../bridge_packages/flame_oxygen/flame_oxygen.html">flame_oxygen</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../bridge_packages/flame_rive/flame_rive.html">flame_rive</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../bridge_packages/flame_rive/rive.html">Overview</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../bridge_packages/flame_splash_screen/flame_splash_screen.html">flame_splash_screen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../bridge_packages/flame_spine/flame_spine.html">flame_spine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../bridge_packages/flame_svg/flame_svg.html">flame_svg</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../bridge_packages/flame_svg/svg.html">Overview</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../bridge_packages/flame_tiled/flame_tiled.html">flame_tiled</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../bridge_packages/flame_tiled/tiled.html">Tiled</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../bridge_packages/flame_tiled/layers.html">Layers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../other_modules/other_modules.html">Other Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../other_modules/jenny/index.html">jenny</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../other_modules/jenny/language/language.html">YarnSpinner language</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../other_modules/jenny/language/nodes.html">Nodes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../other_modules/jenny/language/lines.html">Lines</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../other_modules/jenny/language/options.html">Options</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../other_modules/jenny/language/commands/commands.html">Commands</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../other_modules/jenny/language/commands/character.html">&lt;&lt;character&gt;&gt;</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../other_modules/jenny/language/commands/declare.html">&lt;&lt;declare&gt;&gt;</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../other_modules/jenny/language/commands/if.html">&lt;&lt;if&gt;&gt;</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../other_modules/jenny/language/commands/jump.html">&lt;&lt;jump&gt;&gt;</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../other_modules/jenny/language/commands/local.html">&lt;&lt;local&gt;&gt;</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../other_modules/jenny/language/commands/set.html">&lt;&lt;set&gt;&gt;</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../other_modules/jenny/language/commands/stop.html">&lt;&lt;stop&gt;&gt;</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../other_modules/jenny/language/commands/visit.html">&lt;&lt;visit&gt;&gt;</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../other_modules/jenny/language/commands/wait.html">&lt;&lt;wait&gt;&gt;</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../other_modules/jenny/language/commands/user_defined_commands.html">User-defined commands</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../other_modules/jenny/language/expressions/expressions.html">Expressions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../other_modules/jenny/language/expressions/variables.html">Variables</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../other_modules/jenny/language/expressions/operators.html">Operators</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../other_modules/jenny/language/expressions/functions/functions.html">Functions</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../other_modules/jenny/language/expressions/functions/random.html">Random functions</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../other_modules/jenny/language/expressions/functions/numeric.html">Numeric functions</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../other_modules/jenny/language/expressions/functions/type.html">Type conversion functions</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../other_modules/jenny/language/expressions/functions/misc.html">Miscellaneous functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../other_modules/jenny/language/markup.html">Markup</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../other_modules/jenny/runtime/index.html">Jenny API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../other_modules/jenny/runtime/character.html">Character</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../other_modules/jenny/runtime/character_storage.html">CharacterStorage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../other_modules/jenny/runtime/command_storage.html">CommandStorage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../other_modules/jenny/runtime/dialogue_choice.html">DialogueChoice</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../other_modules/jenny/runtime/dialogue_line.html">DialogueLine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../other_modules/jenny/runtime/dialogue_option.html">DialogueOption</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../other_modules/jenny/runtime/dialogue_runner.html">DialogueRunner</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../other_modules/jenny/runtime/dialogue_view.html">DialogueView</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../other_modules/jenny/runtime/function_storage.html">FunctionStorage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../other_modules/jenny/runtime/markup_attribute.html">MarkupAttribute</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../other_modules/jenny/runtime/node.html">Node</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../other_modules/jenny/runtime/user_defined_command.html">UserDefinedCommand</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../other_modules/jenny/runtime/variable_storage.html">VariableStorage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../other_modules/jenny/runtime/yarn_project.html">YarnProject</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../other_modules/oxygen/oxygen.html">oxygen</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../other_modules/oxygen/components.html">Components</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../bare_flame_game.html">Bare Flame game</a></li>
<li class="toctree-l2"><a class="reference internal" href="../klondike/klondike.html">Klondike</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../klondike/step1.html">1. Preparation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../klondike/step2.html">2. Scaffolding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../klondike/step3.html">3. Cards</a></li>
<li class="toctree-l3"><a class="reference internal" href="../klondike/step4.html">4. Gameplay</a></li>
<li class="toctree-l3"><a class="reference internal" href="../klondike/tbc.html">[To be continued]...</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="platformer.html">Ember Quest</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="step_1.html">1. Preparation</a></li>
<li class="toctree-l3"><a class="reference internal" href="step_2.html">2. Start Coding</a></li>
<li class="toctree-l3"><a class="reference internal" href="step_3.html">3. Building the World</a></li>
<li class="toctree-l3"><a class="reference internal" href="step_4.html">4. Adding the Remaining Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="step_5.html">5. Controlling Movement</a></li>
<li class="toctree-l3"><a class="reference internal" href="step_6.html">6. Adding the HUD</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">7. Adding Menus</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../space_shooter/space_shooter.html">Space Shooter</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../space_shooter/step_1.html">1. Getting Started</a></li>
<li class="toctree-l3"><a class="reference internal" href="../space_shooter/step_2.html">2. Controlling the player and adding some graphics</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../development/development.html">Development</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../development/contributing.html">Contributing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/documentation.html">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/style_guide.html">Style Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/testing_guide.html">Tests Guide</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/resources.html">Resources</a><ul>
<li class="toctree-l2"><a class="reference external" href="https://pub.dev/documentation/flame/1.10.0/">Flame API</a></li>
<li class="toctree-l2"><a class="reference external" href="https://examples.flame-engine.org/#/">Flame Examples</a></li>
</ul>
</li>
</ul>

    </div>
  </div>
</div>

<div class="main-area">
  <div class="document-wrapper">
    <div class="warning hidden" id="version-warning">
      <p><strong>Warning:</strong> you are currently viewing the docs for an older
      version <span class="version"></span> of Flame.</p>
      <p>Please <a href="/">click here</a> to go see the documentation for the latest
      released version.</p>
    </div>
    <div class="document" role="main">
      
  <section class="tex2jax_ignore mathjax_ignore" id="adding-menus">
<h1>7. Adding Menus<a class="headerlink" href="#adding-menus" title="Link to this heading">Â¶</a></h1>
<p>To add menus to the game, we will leverage Flameâ€™s built-in
<a class="reference internal" href="../../flame/overlays.html"><span class="std std-doc">overlay</span></a> system.</p>
<section id="main-menu">
<h2>Main Menu<a class="headerlink" href="#main-menu" title="Link to this heading">Â¶</a></h2>
<p>In the <code class="docutils literal notranslate"><span class="pre">lib/overlays</span></code> folder, create <code class="docutils literal notranslate"><span class="pre">main_menu.dart</span></code> and add the following code:</p>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/material.dart&#39;</span><span class="p">;</span>

<span class="k">import</span><span class="w"> </span><span class="s1">&#39;../ember_quest.dart&#39;</span><span class="p">;</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">MainMenu</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Reference to parent game.</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">EmberQuestGame</span><span class="w"> </span><span class="n">game</span><span class="p">;</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">MainMenu</span><span class="p">({</span><span class="k">super</span><span class="p">.</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">game</span><span class="p">});</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">blackTextColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="n">fromRGBO</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1.0</span><span class="p">);</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">whiteTextColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="n">fromRGBO</span><span class="p">(</span><span class="m">255</span><span class="p">,</span><span class="w"> </span><span class="m">255</span><span class="p">,</span><span class="w"> </span><span class="m">255</span><span class="p">,</span><span class="w"> </span><span class="m">1.0</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Material</span><span class="p">(</span>
<span class="w">      </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">transparent</span><span class="p">,</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">          </span><span class="nl">padding:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">10.0</span><span class="p">),</span>
<span class="w">          </span><span class="nl">height:</span><span class="w"> </span><span class="m">250</span><span class="p">,</span>
<span class="w">          </span><span class="nl">width:</span><span class="w"> </span><span class="m">300</span><span class="p">,</span>
<span class="w">          </span><span class="nl">decoration:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">BoxDecoration</span><span class="p">(</span>
<span class="w">            </span><span class="nl">color:</span><span class="w"> </span><span class="n">blackTextColor</span><span class="p">,</span>
<span class="w">            </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">all</span><span class="p">(</span>
<span class="w">              </span><span class="n">Radius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">20</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">            </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="w">            </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">              </span><span class="k">const</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                </span><span class="s1">&#39;Ember Quest&#39;</span><span class="p">,</span>
<span class="w">                </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">color:</span><span class="w"> </span><span class="n">whiteTextColor</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">24</span><span class="p">,</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">              </span><span class="k">const</span><span class="w"> </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">40</span><span class="p">),</span>
<span class="w">              </span><span class="n">SizedBox</span><span class="p">(</span>
<span class="w">                </span><span class="nl">width:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="w">                </span><span class="nl">height:</span><span class="w"> </span><span class="m">75</span><span class="p">,</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">game</span><span class="p">.</span><span class="n">overlays</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;MainMenu&#39;</span><span class="p">);</span>
<span class="w">                  </span><span class="p">},</span>
<span class="w">                  </span><span class="nl">style:</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">.</span><span class="n">styleFrom</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">backgroundColor:</span><span class="w"> </span><span class="n">whiteTextColor</span><span class="p">,</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                  </span><span class="nl">child:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                    </span><span class="s1">&#39;Play&#39;</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                      </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">40.0</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">color:</span><span class="w"> </span><span class="n">blackTextColor</span><span class="p">,</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">              </span><span class="k">const</span><span class="w"> </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">20</span><span class="p">),</span>
<span class="w">              </span><span class="k">const</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="s1">&#39;&#39;&#39;Use WASD or Arrow Keys for movement.</span>
<span class="s1">Space bar to jump.</span>
<span class="s1">Collect as many stars as you can and avoid enemies!&#39;&#39;&#39;</span><span class="p">,</span>
<span class="w">                </span><span class="nl">textAlign:</span><span class="w"> </span><span class="n">TextAlign</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="w">                </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">color:</span><span class="w"> </span><span class="n">whiteTextColor</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">14</span><span class="p">,</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This is a pretty self-explanatory file that just uses standard Flutter widgets to display
information and provide a <code class="docutils literal notranslate"><span class="pre">Play</span></code> button. The only Flame-related line is
<code class="docutils literal notranslate"><span class="pre">game.overlays.remove('MainMenu');</span></code> which simply removes the overlay so the user can play the
game. It should be noted that the user can technically move Ember while this is displayed, but
trapping the input is outside the scope of this tutorial as there are multiple ways this can be
accomplished.</p>
</section>
<section id="game-over-menu">
<h2>Game Over Menu<a class="headerlink" href="#game-over-menu" title="Link to this heading">Â¶</a></h2>
<p>Next, create a file called <code class="docutils literal notranslate"><span class="pre">lib/overlays/game_over.dart</span></code> and add the following code:</p>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/material.dart&#39;</span><span class="p">;</span>

<span class="k">import</span><span class="w"> </span><span class="s1">&#39;../ember_quest.dart&#39;</span><span class="p">;</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">GameOver</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Reference to parent game.</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">EmberQuestGame</span><span class="w"> </span><span class="n">game</span><span class="p">;</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">GameOver</span><span class="p">({</span><span class="k">super</span><span class="p">.</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">game</span><span class="p">});</span>

<span class="w">  </span><span class="nd">@override</span>
<span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">blackTextColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="n">fromRGBO</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1.0</span><span class="p">);</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">whiteTextColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="n">fromRGBO</span><span class="p">(</span><span class="m">255</span><span class="p">,</span><span class="w"> </span><span class="m">255</span><span class="p">,</span><span class="w"> </span><span class="m">255</span><span class="p">,</span><span class="w"> </span><span class="m">1.0</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Material</span><span class="p">(</span>
<span class="w">      </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">transparent</span><span class="p">,</span>
<span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span>
<span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="w">          </span><span class="nl">padding:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">10.0</span><span class="p">),</span>
<span class="w">          </span><span class="nl">height:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="w">          </span><span class="nl">width:</span><span class="w"> </span><span class="m">300</span><span class="p">,</span>
<span class="w">          </span><span class="nl">decoration:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">BoxDecoration</span><span class="p">(</span>
<span class="w">            </span><span class="nl">color:</span><span class="w"> </span><span class="n">blackTextColor</span><span class="p">,</span>
<span class="w">            </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">all</span><span class="p">(</span>
<span class="w">              </span><span class="n">Radius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">20</span><span class="p">),</span>
<span class="w">            </span><span class="p">),</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="w">            </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="w">            </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="w">              </span><span class="k">const</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                </span><span class="s1">&#39;Game Over&#39;</span><span class="p">,</span>
<span class="w">                </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">color:</span><span class="w"> </span><span class="n">whiteTextColor</span><span class="p">,</span>
<span class="w">                  </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">24</span><span class="p">,</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">              </span><span class="k">const</span><span class="w"> </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">40</span><span class="p">),</span>
<span class="w">              </span><span class="n">SizedBox</span><span class="p">(</span>
<span class="w">                </span><span class="nl">width:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="w">                </span><span class="nl">height:</span><span class="w"> </span><span class="m">75</span><span class="p">,</span>
<span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="w">                  </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">game</span><span class="p">.</span><span class="n">reset</span><span class="p">();</span>
<span class="w">                    </span><span class="n">game</span><span class="p">.</span><span class="n">overlays</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;GameOver&#39;</span><span class="p">);</span>
<span class="w">                  </span><span class="p">},</span>
<span class="w">                  </span><span class="nl">style:</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">.</span><span class="n">styleFrom</span><span class="p">(</span>
<span class="w">                    </span><span class="nl">backgroundColor:</span><span class="w"> </span><span class="n">whiteTextColor</span><span class="p">,</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                  </span><span class="nl">child:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                    </span><span class="s1">&#39;Play Again&#39;</span><span class="p">,</span>
<span class="w">                    </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">                      </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">28.0</span><span class="p">,</span>
<span class="w">                      </span><span class="nl">color:</span><span class="w"> </span><span class="n">blackTextColor</span><span class="p">,</span>
<span class="w">                    </span><span class="p">),</span>
<span class="w">                  </span><span class="p">),</span>
<span class="w">                </span><span class="p">),</span>
<span class="w">              </span><span class="p">),</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">          </span><span class="p">),</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">      </span><span class="p">),</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>As with the Main Menu, this is all standard Flutter widgets except for the call to remove the
overlay and also the call to <code class="docutils literal notranslate"><span class="pre">game.reset()</span></code> which we will create now.</p>
<p>Open <code class="docutils literal notranslate"><span class="pre">lib/ember_quest.dart</span></code> and add / update the following code:</p>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="nd">@override</span>
<span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">onLoad</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">await</span><span class="w"> </span><span class="n">images</span><span class="p">.</span><span class="n">loadAll</span><span class="p">([</span>
<span class="w">      </span><span class="s1">&#39;block.png&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;ember.png&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;ground.png&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;heart_half.png&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;heart.png&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;star.png&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="s1">&#39;water_enemy.png&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="p">]);</span>
<span class="w">  </span><span class="n">cameraComponent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CameraComponent</span><span class="p">(</span><span class="nl">world:</span><span class="w"> </span><span class="n">world</span><span class="p">);</span>
<span class="w">  </span><span class="n">cameraComponent</span><span class="p">.</span><span class="n">viewfinder</span><span class="p">.</span><span class="n">anchor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Anchor</span><span class="p">.</span><span class="n">topLeft</span><span class="p">;</span>
<span class="w">  </span><span class="n">addAll</span><span class="p">([</span><span class="n">cameraComponent</span><span class="p">,</span><span class="w"> </span><span class="n">world</span><span class="p">]);</span>

<span class="w">  </span><span class="n">initializeGame</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="n">initializeGame</span><span class="p">(</span><span class="kt">bool</span><span class="w"> </span><span class="n">loadHud</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Assume that size.x &lt; 3200</span>
<span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">segmentsToLoad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">size</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">640</span><span class="p">).</span><span class="n">ceil</span><span class="p">();</span>
<span class="w">  </span><span class="n">segmentsToLoad</span><span class="p">.</span><span class="n">clamp</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">segments</span><span class="p">.</span><span class="n">length</span><span class="p">);</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">segmentsToLoad</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">loadGameSegments</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="m">640</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i</span><span class="p">).</span><span class="n">toDouble</span><span class="p">());</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">_ember</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EmberPlayer</span><span class="p">(</span>
<span class="w">    </span><span class="nl">position:</span><span class="w"> </span><span class="n">Vector2</span><span class="p">(</span><span class="m">128</span><span class="p">,</span><span class="w"> </span><span class="n">canvasSize</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">128</span><span class="p">),</span>
<span class="w">  </span><span class="p">);</span>
<span class="w">  </span><span class="n">add</span><span class="p">(</span><span class="n">_ember</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">loadHud</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">add</span><span class="p">(</span><span class="n">Hud</span><span class="p">());</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="n">reset</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">starsCollected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">health</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">;</span>
<span class="w">  </span><span class="n">initializeGame</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You may notice that we have added a parameter to the <code class="docutils literal notranslate"><span class="pre">initializeGame</span></code> method which allows us to
bypass adding the HUD to the game. This is because in the coming section, when Emberâ€™s health drops
to 0, we will wipe the game, but we do not need to remove the HUD, as we just simply need to reset
the values using <code class="docutils literal notranslate"><span class="pre">reset()</span></code>.</p>
</section>
<section id="displaying-the-menus">
<h2>Displaying the Menus<a class="headerlink" href="#displaying-the-menus" title="Link to this heading">Â¶</a></h2>
<p>To display the menus, add the following code to <code class="docutils literal notranslate"><span class="pre">lib/main.dart</span></code>:</p>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">runApp</span><span class="p">(</span>
<span class="w">    </span><span class="n">GameWidget</span><span class="o">&lt;</span><span class="n">EmberQuestGame</span><span class="o">&gt;</span><span class="p">.</span><span class="n">controlled</span><span class="p">(</span>
<span class="w">      </span><span class="nl">gameFactory:</span><span class="w"> </span><span class="n">EmberQuestGame</span><span class="p">.</span><span class="k">new</span><span class="p">,</span>
<span class="w">      </span><span class="nl">overlayBuilderMap:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s1">&#39;MainMenu&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">game</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">MainMenu</span><span class="p">(</span><span class="nl">game:</span><span class="w"> </span><span class="n">game</span><span class="p">),</span>
<span class="w">        </span><span class="s1">&#39;GameOver&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">game</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">GameOver</span><span class="p">(</span><span class="nl">game:</span><span class="w"> </span><span class="n">game</span><span class="p">),</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nl">initialActiveOverlays:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;MainMenu&#39;</span><span class="p">],</span>
<span class="w">    </span><span class="p">),</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If the menus did not auto-import, add the following:</p>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;overlays/game_over.dart&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s1">&#39;overlays/main_menu.dart&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>If you run the game now, you should be greeted with the Main Menu overlay. Pressing play will
remove it and allow you to start playing the game.</p>
<section id="health-check-for-game-over">
<h3>Health Check for Game Over<a class="headerlink" href="#health-check-for-game-over" title="Link to this heading">Â¶</a></h3>
<p>Our last step to finish Ember Quest is to add a game-over mechanism. This is fairly simple but
requires us to place similar code in all of our components. So letâ€™s get started!</p>
<p>In <code class="docutils literal notranslate"><span class="pre">lib/actors/ember.dart</span></code>, in the <code class="docutils literal notranslate"><span class="pre">update</span></code> method, add the following:</p>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="c1">// If ember fell in pit, then game over.</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">position</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">game</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">size</span><span class="p">.</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">game</span><span class="p">.</span><span class="n">health</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">game</span><span class="p">.</span><span class="n">health</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">removeFromParent</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In <code class="docutils literal notranslate"><span class="pre">lib/actors/water_enemy.dart</span></code>, in the <code class="docutils literal notranslate"><span class="pre">update</span></code> method update the following code:</p>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">position</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="o">-</span><span class="n">size</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">game</span><span class="p">.</span><span class="n">health</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">removeFromParent</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In <code class="docutils literal notranslate"><span class="pre">lib/objects/ground_block.dart</span></code>, in the <code class="docutils literal notranslate"><span class="pre">update</span></code> method update the following code:</p>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">game</span><span class="p">.</span><span class="n">health</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">removeFromParent</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In <code class="docutils literal notranslate"><span class="pre">lib/objects/platform_block.dart</span></code>, in the <code class="docutils literal notranslate"><span class="pre">update</span></code> method update the following code:</p>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">position</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="o">-</span><span class="n">size</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">game</span><span class="p">.</span><span class="n">health</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">removeFromParent</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In <code class="docutils literal notranslate"><span class="pre">lib/objects/star.dart</span></code>, in the <code class="docutils literal notranslate"><span class="pre">update</span></code> method update the following code:</p>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">position</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="o">-</span><span class="n">size</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">game</span><span class="p">.</span><span class="n">health</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">removeFromParent</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Finally, in <code class="docutils literal notranslate"><span class="pre">lib/ember_quest.dart</span></code>, add the following <code class="docutils literal notranslate"><span class="pre">update</span></code> method:</p>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="nd">@override</span>
<span class="kt">void</span><span class="w"> </span><span class="n">update</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">dt</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">health</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">overlays</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;GameOver&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="congratulations">
<h2>Congratulations<a class="headerlink" href="#congratulations" title="Link to this heading">Â¶</a></h2>
<p>You made it! You have a working Ember Quest. Press the button below to see what the resulting code
looks like or to play it live.</p>
<button class="flutter-app-button popup" onclick="run_flutter_app(&quot;/1.10.0/_static/apps/tutorials-platformer-app/index.html?&quot;)">Run</button><div class="flutter-app-code docutils container" id="tutorials-platformer-app-source-">
<div class="filename docutils container">
actors/ember.dart</div>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flame/collisions.dart&#39;</span><span class="p">;</span>
<span class="linenos">  2</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flame/components.dart&#39;</span><span class="p">;</span>
<span class="linenos">  3</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flame/effects.dart&#39;</span><span class="p">;</span>
<span class="linenos">  4</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/services.dart&#39;</span><span class="p">;</span>
<span class="linenos">  5</span>
<span class="linenos">  6</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;../ember_quest.dart&#39;</span><span class="p">;</span>
<span class="linenos">  7</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;../objects/ground_block.dart&#39;</span><span class="p">;</span>
<span class="linenos">  8</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;../objects/platform_block.dart&#39;</span><span class="p">;</span>
<span class="linenos">  9</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;../objects/star.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 10</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;water_enemy.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 11</span>
<span class="linenos"> 12</span><span class="kd">class</span><span class="w"> </span><span class="nc">EmberPlayer</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">SpriteAnimationComponent</span>
<span class="linenos"> 13</span><span class="w">    </span><span class="kd">with</span><span class="w"> </span><span class="n">KeyboardHandler</span><span class="p">,</span><span class="w"> </span><span class="n">CollisionCallbacks</span><span class="p">,</span><span class="w"> </span><span class="n">HasGameReference</span><span class="o">&lt;</span><span class="n">EmberQuestGame</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 14</span><span class="w">  </span><span class="n">EmberPlayer</span><span class="p">({</span>
<span class="linenos"> 15</span><span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">super</span><span class="p">.</span><span class="n">position</span><span class="p">,</span>
<span class="linenos"> 16</span><span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">size:</span><span class="w"> </span><span class="n">Vector2</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">64</span><span class="p">),</span><span class="w"> </span><span class="nl">anchor:</span><span class="w"> </span><span class="n">Anchor</span><span class="p">.</span><span class="n">center</span><span class="p">);</span>
<span class="linenos"> 17</span>
<span class="linenos"> 18</span><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Vector2</span><span class="w"> </span><span class="n">velocity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Vector2</span><span class="p">.</span><span class="n">zero</span><span class="p">();</span>
<span class="linenos"> 19</span><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Vector2</span><span class="w"> </span><span class="n">fromAbove</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Vector2</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="m">1</span><span class="p">);</span>
<span class="linenos"> 20</span><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">gravity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span><span class="p">;</span>
<span class="linenos"> 21</span><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">jumpSpeed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">600</span><span class="p">;</span>
<span class="linenos"> 22</span><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">moveSpeed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">200</span><span class="p">;</span>
<span class="linenos"> 23</span><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">terminalVelocity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">150</span><span class="p">;</span>
<span class="linenos"> 24</span><span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">horizontalDirection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<span class="linenos"> 25</span>
<span class="linenos"> 26</span><span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">hasJumped</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="linenos"> 27</span><span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">isOnGround</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="linenos"> 28</span><span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">hitByEnemy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="linenos"> 29</span>
<span class="linenos"> 30</span><span class="w">  </span><span class="nd">@override</span>
<span class="linenos"> 31</span><span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">onLoad</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 32</span><span class="w">    </span><span class="n">animation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SpriteAnimation</span><span class="p">.</span><span class="n">fromFrameData</span><span class="p">(</span>
<span class="linenos"> 33</span><span class="w">      </span><span class="n">game</span><span class="p">.</span><span class="n">images</span><span class="p">.</span><span class="n">fromCache</span><span class="p">(</span><span class="s1">&#39;ember.png&#39;</span><span class="p">),</span>
<span class="linenos"> 34</span><span class="w">      </span><span class="n">SpriteAnimationData</span><span class="p">.</span><span class="n">sequenced</span><span class="p">(</span>
<span class="linenos"> 35</span><span class="w">        </span><span class="nl">amount:</span><span class="w"> </span><span class="m">4</span><span class="p">,</span>
<span class="linenos"> 36</span><span class="w">        </span><span class="nl">textureSize:</span><span class="w"> </span><span class="n">Vector2</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="linenos"> 37</span><span class="w">        </span><span class="nl">stepTime:</span><span class="w"> </span><span class="m">0.12</span><span class="p">,</span>
<span class="linenos"> 38</span><span class="w">      </span><span class="p">),</span>
<span class="linenos"> 39</span><span class="w">    </span><span class="p">);</span>
<span class="linenos"> 40</span>
<span class="linenos"> 41</span><span class="w">    </span><span class="n">add</span><span class="p">(</span>
<span class="linenos"> 42</span><span class="w">      </span><span class="n">CircleHitbox</span><span class="p">(),</span>
<span class="linenos"> 43</span><span class="w">    </span><span class="p">);</span>
<span class="linenos"> 44</span><span class="w">  </span><span class="p">}</span>
<span class="linenos"> 45</span>
<span class="linenos"> 46</span><span class="w">  </span><span class="nd">@override</span>
<span class="linenos"> 47</span><span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">onKeyEvent</span><span class="p">(</span><span class="n">RawKeyEvent</span><span class="w"> </span><span class="n">event</span><span class="p">,</span><span class="w"> </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">LogicalKeyboardKey</span><span class="o">&gt;</span><span class="w"> </span><span class="n">keysPressed</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 48</span><span class="w">    </span><span class="n">horizontalDirection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<span class="linenos"> 49</span><span class="w">    </span><span class="n">horizontalDirection</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="n">keysPressed</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="n">LogicalKeyboardKey</span><span class="p">.</span><span class="n">keyA</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
<span class="linenos"> 50</span><span class="w">            </span><span class="n">keysPressed</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="n">LogicalKeyboardKey</span><span class="p">.</span><span class="n">arrowLeft</span><span class="p">))</span>
<span class="linenos"> 51</span><span class="w">        </span><span class="o">?</span><span class="w"> </span><span class="o">-</span><span class="m">1</span>
<span class="linenos"> 52</span><span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<span class="linenos"> 53</span><span class="w">    </span><span class="n">horizontalDirection</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="n">keysPressed</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="n">LogicalKeyboardKey</span><span class="p">.</span><span class="n">keyD</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
<span class="linenos"> 54</span><span class="w">            </span><span class="n">keysPressed</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="n">LogicalKeyboardKey</span><span class="p">.</span><span class="n">arrowRight</span><span class="p">))</span>
<span class="linenos"> 55</span><span class="w">        </span><span class="o">?</span><span class="w"> </span><span class="m">1</span>
<span class="linenos"> 56</span><span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<span class="linenos"> 57</span>
<span class="linenos"> 58</span><span class="w">    </span><span class="n">hasJumped</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">keysPressed</span><span class="p">.</span><span class="n">contains</span><span class="p">(</span><span class="n">LogicalKeyboardKey</span><span class="p">.</span><span class="n">space</span><span class="p">);</span>
<span class="linenos"> 59</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="linenos"> 60</span><span class="w">  </span><span class="p">}</span>
<span class="linenos"> 61</span>
<span class="linenos"> 62</span><span class="w">  </span><span class="nd">@override</span>
<span class="linenos"> 63</span><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">update</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">dt</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 64</span><span class="w">    </span><span class="n">velocity</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">horizontalDirection</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">moveSpeed</span><span class="p">;</span>
<span class="linenos"> 65</span><span class="w">    </span><span class="n">game</span><span class="p">.</span><span class="n">objectSpeed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<span class="linenos"> 66</span><span class="w">    </span><span class="c1">// Prevent ember from going backwards at screen edge.</span>
<span class="linenos"> 67</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">position</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">36</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">horizontalDirection</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 68</span><span class="w">      </span><span class="n">velocity</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<span class="linenos"> 69</span><span class="w">    </span><span class="p">}</span>
<span class="linenos"> 70</span><span class="w">    </span><span class="c1">// Prevent ember from going beyond half screen.</span>
<span class="linenos"> 71</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">position</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">64</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">game</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">horizontalDirection</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 72</span><span class="w">      </span><span class="n">velocity</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<span class="linenos"> 73</span><span class="w">      </span><span class="n">game</span><span class="p">.</span><span class="n">objectSpeed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">moveSpeed</span><span class="p">;</span>
<span class="linenos"> 74</span><span class="w">    </span><span class="p">}</span>
<span class="linenos"> 75</span>
<span class="linenos"> 76</span><span class="w">    </span><span class="c1">// Apply basic gravity.</span>
<span class="linenos"> 77</span><span class="w">    </span><span class="n">velocity</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">gravity</span><span class="p">;</span>
<span class="linenos"> 78</span>
<span class="linenos"> 79</span><span class="w">    </span><span class="c1">// Determine if ember has jumped.</span>
<span class="linenos"> 80</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">hasJumped</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 81</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isOnGround</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 82</span><span class="w">        </span><span class="n">velocity</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">jumpSpeed</span><span class="p">;</span>
<span class="linenos"> 83</span><span class="w">        </span><span class="n">isOnGround</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="linenos"> 84</span><span class="w">      </span><span class="p">}</span>
<span class="linenos"> 85</span><span class="w">      </span><span class="n">hasJumped</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="linenos"> 86</span><span class="w">    </span><span class="p">}</span>
<span class="linenos"> 87</span>
<span class="linenos"> 88</span><span class="w">    </span><span class="c1">// Prevent ember from jumping to crazy fast.</span>
<span class="linenos"> 89</span><span class="w">    </span><span class="n">velocity</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">velocity</span><span class="p">.</span><span class="n">y</span><span class="p">.</span><span class="n">clamp</span><span class="p">(</span><span class="o">-</span><span class="n">jumpSpeed</span><span class="p">,</span><span class="w"> </span><span class="n">terminalVelocity</span><span class="p">);</span>
<span class="linenos"> 90</span>
<span class="linenos"> 91</span><span class="w">    </span><span class="c1">// Adjust ember position.</span>
<span class="linenos"> 92</span><span class="w">    </span><span class="n">position</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">velocity</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dt</span><span class="p">;</span>
<span class="linenos"> 93</span>
<span class="linenos"> 94</span><span class="w">    </span><span class="c1">// If ember fell in pit, then game over.</span>
<span class="linenos"> 95</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">position</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">game</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">size</span><span class="p">.</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 96</span><span class="w">      </span><span class="n">game</span><span class="p">.</span><span class="n">health</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<span class="linenos"> 97</span><span class="w">    </span><span class="p">}</span>
<span class="linenos"> 98</span>
<span class="linenos"> 99</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">game</span><span class="p">.</span><span class="n">health</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">100</span><span class="w">      </span><span class="n">removeFromParent</span><span class="p">();</span>
<span class="linenos">101</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">102</span>
<span class="linenos">103</span><span class="w">    </span><span class="c1">// Flip ember if needed.</span>
<span class="linenos">104</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">horizontalDirection</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">scale</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">105</span><span class="w">      </span><span class="n">flipHorizontally</span><span class="p">();</span>
<span class="linenos">106</span><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">horizontalDirection</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">scale</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">107</span><span class="w">      </span><span class="n">flipHorizontally</span><span class="p">();</span>
<span class="linenos">108</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">109</span><span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">dt</span><span class="p">);</span>
<span class="linenos">110</span><span class="w">  </span><span class="p">}</span>
<span class="linenos">111</span>
<span class="linenos">112</span><span class="w">  </span><span class="nd">@override</span>
<span class="linenos">113</span><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">onCollision</span><span class="p">(</span><span class="n">Set</span><span class="o">&lt;</span><span class="n">Vector2</span><span class="o">&gt;</span><span class="w"> </span><span class="n">intersectionPoints</span><span class="p">,</span><span class="w"> </span><span class="n">PositionComponent</span><span class="w"> </span><span class="n">other</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">114</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">other</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">GroundBlock</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">PlatformBlock</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">115</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">intersectionPoints</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">116</span><span class="w">        </span><span class="c1">// Calculate the collision normal and separation distance.</span>
<span class="linenos">117</span><span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">mid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">intersectionPoints</span><span class="p">.</span><span class="n">elementAt</span><span class="p">(</span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="linenos">118</span><span class="w">                </span><span class="n">intersectionPoints</span><span class="p">.</span><span class="n">elementAt</span><span class="p">(</span><span class="m">1</span><span class="p">))</span><span class="w"> </span><span class="o">/</span>
<span class="linenos">119</span><span class="w">            </span><span class="m">2</span><span class="p">;</span>
<span class="linenos">120</span>
<span class="linenos">121</span><span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">collisionNormal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">absoluteCenter</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mid</span><span class="p">;</span>
<span class="linenos">122</span><span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">separationDistance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">size</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">collisionNormal</span><span class="p">.</span><span class="n">length</span><span class="p">;</span>
<span class="linenos">123</span><span class="w">        </span><span class="n">collisionNormal</span><span class="p">.</span><span class="n">normalize</span><span class="p">();</span>
<span class="linenos">124</span>
<span class="linenos">125</span><span class="w">        </span><span class="c1">// If collision normal is almost upwards,</span>
<span class="linenos">126</span><span class="w">        </span><span class="c1">// ember must be on ground.</span>
<span class="linenos">127</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fromAbove</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">collisionNormal</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0.9</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">128</span><span class="w">          </span><span class="n">isOnGround</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="linenos">129</span><span class="w">        </span><span class="p">}</span>
<span class="linenos">130</span>
<span class="linenos">131</span><span class="w">        </span><span class="c1">// Resolve collision by moving ember along</span>
<span class="linenos">132</span><span class="w">        </span><span class="c1">// collision normal by separation distance.</span>
<span class="linenos">133</span><span class="w">        </span><span class="n">position</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">collisionNormal</span><span class="p">.</span><span class="n">scaled</span><span class="p">(</span><span class="n">separationDistance</span><span class="p">);</span>
<span class="linenos">134</span><span class="w">      </span><span class="p">}</span>
<span class="linenos">135</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">136</span>
<span class="linenos">137</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">other</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">Star</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">138</span><span class="w">      </span><span class="n">other</span><span class="p">.</span><span class="n">removeFromParent</span><span class="p">();</span>
<span class="linenos">139</span><span class="w">      </span><span class="n">game</span><span class="p">.</span><span class="n">starsCollected</span><span class="o">++</span><span class="p">;</span>
<span class="linenos">140</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">141</span>
<span class="linenos">142</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">other</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">WaterEnemy</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">143</span><span class="w">      </span><span class="n">hit</span><span class="p">();</span>
<span class="linenos">144</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">145</span><span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">onCollision</span><span class="p">(</span><span class="n">intersectionPoints</span><span class="p">,</span><span class="w"> </span><span class="n">other</span><span class="p">);</span>
<span class="linenos">146</span><span class="w">  </span><span class="p">}</span>
<span class="linenos">147</span>
<span class="linenos">148</span><span class="w">  </span><span class="c1">// This method runs an opacity effect on ember</span>
<span class="linenos">149</span><span class="w">  </span><span class="c1">// to make it blink.</span>
<span class="linenos">150</span><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">hit</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">151</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">hitByEnemy</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">152</span><span class="w">      </span><span class="n">game</span><span class="p">.</span><span class="n">health</span><span class="o">--</span><span class="p">;</span>
<span class="linenos">153</span><span class="w">      </span><span class="n">hitByEnemy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="linenos">154</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">155</span><span class="w">    </span><span class="n">add</span><span class="p">(</span>
<span class="linenos">156</span><span class="w">      </span><span class="n">OpacityEffect</span><span class="p">.</span><span class="n">fadeOut</span><span class="p">(</span>
<span class="linenos">157</span><span class="w">        </span><span class="n">EffectController</span><span class="p">(</span>
<span class="linenos">158</span><span class="w">          </span><span class="nl">alternate:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="linenos">159</span><span class="w">          </span><span class="nl">duration:</span><span class="w"> </span><span class="m">0.1</span><span class="p">,</span>
<span class="linenos">160</span><span class="w">          </span><span class="nl">repeatCount:</span><span class="w"> </span><span class="m">5</span><span class="p">,</span>
<span class="linenos">161</span><span class="w">        </span><span class="p">),</span>
<span class="linenos">162</span><span class="w">      </span><span class="p">)..</span><span class="n">onComplete</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">163</span><span class="w">          </span><span class="n">hitByEnemy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="linenos">164</span><span class="w">        </span><span class="p">},</span>
<span class="linenos">165</span><span class="w">    </span><span class="p">);</span>
<span class="linenos">166</span><span class="w">  </span><span class="p">}</span>
<span class="linenos">167</span><span class="p">}</span>
</pre></div>
</div>
<div class="filename docutils container">
actors/water_enemy.dart</div>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flame/collisions.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 2</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flame/components.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 3</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flame/effects.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;../ember_quest.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="kd">class</span><span class="w"> </span><span class="nc">WaterEnemy</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">SpriteAnimationComponent</span>
<span class="linenos"> 8</span><span class="w">    </span><span class="kd">with</span><span class="w"> </span><span class="n">HasGameReference</span><span class="o">&lt;</span><span class="n">EmberQuestGame</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 9</span><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Vector2</span><span class="w"> </span><span class="n">gridPosition</span><span class="p">;</span>
<span class="linenos">10</span><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">xOffset</span><span class="p">;</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Vector2</span><span class="w"> </span><span class="n">velocity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Vector2</span><span class="p">.</span><span class="n">zero</span><span class="p">();</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="w">  </span><span class="n">WaterEnemy</span><span class="p">({</span>
<span class="linenos">15</span><span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">gridPosition</span><span class="p">,</span>
<span class="linenos">16</span><span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">xOffset</span><span class="p">,</span>
<span class="linenos">17</span><span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">size:</span><span class="w"> </span><span class="n">Vector2</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">64</span><span class="p">),</span><span class="w"> </span><span class="nl">anchor:</span><span class="w"> </span><span class="n">Anchor</span><span class="p">.</span><span class="n">bottomLeft</span><span class="p">);</span>
<span class="linenos">18</span>
<span class="linenos">19</span><span class="w">  </span><span class="nd">@override</span>
<span class="linenos">20</span><span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">onLoad</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">21</span><span class="w">    </span><span class="n">animation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SpriteAnimation</span><span class="p">.</span><span class="n">fromFrameData</span><span class="p">(</span>
<span class="linenos">22</span><span class="w">      </span><span class="n">game</span><span class="p">.</span><span class="n">images</span><span class="p">.</span><span class="n">fromCache</span><span class="p">(</span><span class="s1">&#39;water_enemy.png&#39;</span><span class="p">),</span>
<span class="linenos">23</span><span class="w">      </span><span class="n">SpriteAnimationData</span><span class="p">.</span><span class="n">sequenced</span><span class="p">(</span>
<span class="linenos">24</span><span class="w">        </span><span class="nl">amount:</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<span class="linenos">25</span><span class="w">        </span><span class="nl">textureSize:</span><span class="w"> </span><span class="n">Vector2</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">16</span><span class="p">),</span>
<span class="linenos">26</span><span class="w">        </span><span class="nl">stepTime:</span><span class="w"> </span><span class="m">0.70</span><span class="p">,</span>
<span class="linenos">27</span><span class="w">      </span><span class="p">),</span>
<span class="linenos">28</span><span class="w">    </span><span class="p">);</span>
<span class="linenos">29</span><span class="w">    </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Vector2</span><span class="p">(</span>
<span class="linenos">30</span><span class="w">      </span><span class="p">(</span><span class="n">gridPosition</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">size</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xOffset</span><span class="p">,</span>
<span class="linenos">31</span><span class="w">      </span><span class="n">game</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">gridPosition</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">size</span><span class="p">.</span><span class="n">y</span><span class="p">),</span>
<span class="linenos">32</span><span class="w">    </span><span class="p">);</span>
<span class="linenos">33</span><span class="w">    </span><span class="n">add</span><span class="p">(</span><span class="n">RectangleHitbox</span><span class="p">(</span><span class="nl">collisionType:</span><span class="w"> </span><span class="n">CollisionType</span><span class="p">.</span><span class="n">passive</span><span class="p">));</span>
<span class="linenos">34</span><span class="w">    </span><span class="n">add</span><span class="p">(</span>
<span class="linenos">35</span><span class="w">      </span><span class="n">MoveEffect</span><span class="p">.</span><span class="n">by</span><span class="p">(</span>
<span class="linenos">36</span><span class="w">        </span><span class="n">Vector2</span><span class="p">(</span><span class="o">-</span><span class="m">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">size</span><span class="p">.</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span>
<span class="linenos">37</span><span class="w">        </span><span class="n">EffectController</span><span class="p">(</span>
<span class="linenos">38</span><span class="w">          </span><span class="nl">duration:</span><span class="w"> </span><span class="m">3</span><span class="p">,</span>
<span class="linenos">39</span><span class="w">          </span><span class="nl">alternate:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="linenos">40</span><span class="w">          </span><span class="nl">infinite:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="linenos">41</span><span class="w">        </span><span class="p">),</span>
<span class="linenos">42</span><span class="w">      </span><span class="p">),</span>
<span class="linenos">43</span><span class="w">    </span><span class="p">);</span>
<span class="linenos">44</span><span class="w">  </span><span class="p">}</span>
<span class="linenos">45</span>
<span class="linenos">46</span><span class="w">  </span><span class="nd">@override</span>
<span class="linenos">47</span><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">update</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">dt</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">48</span><span class="w">    </span><span class="n">velocity</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">game</span><span class="p">.</span><span class="n">objectSpeed</span><span class="p">;</span>
<span class="linenos">49</span><span class="w">    </span><span class="n">position</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">velocity</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dt</span><span class="p">;</span>
<span class="linenos">50</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">position</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="o">-</span><span class="n">size</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">game</span><span class="p">.</span><span class="n">health</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">51</span><span class="w">      </span><span class="n">removeFromParent</span><span class="p">();</span>
<span class="linenos">52</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">53</span><span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">dt</span><span class="p">);</span>
<span class="linenos">54</span><span class="w">  </span><span class="p">}</span>
<span class="linenos">55</span><span class="p">}</span>
</pre></div>
</div>
<div class="filename docutils container">
ember_quest.dart</div>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flame/components.dart&#39;</span><span class="p">;</span>
<span class="linenos">  2</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flame/events.dart&#39;</span><span class="p">;</span>
<span class="linenos">  3</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flame/game.dart&#39;</span><span class="p">;</span>
<span class="linenos">  4</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/material.dart&#39;</span><span class="p">;</span>
<span class="linenos">  5</span>
<span class="linenos">  6</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;actors/ember.dart&#39;</span><span class="p">;</span>
<span class="linenos">  7</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;actors/water_enemy.dart&#39;</span><span class="p">;</span>
<span class="linenos">  8</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;managers/segment_manager.dart&#39;</span><span class="p">;</span>
<span class="linenos">  9</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;objects/ground_block.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 10</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;objects/platform_block.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 11</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;objects/star.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 12</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;overlays/hud.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 13</span>
<span class="linenos"> 14</span><span class="kd">class</span><span class="w"> </span><span class="nc">EmberQuestGame</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">FlameGame</span>
<span class="linenos"> 15</span><span class="w">    </span><span class="kd">with</span><span class="w"> </span><span class="n">HasCollisionDetection</span><span class="p">,</span><span class="w"> </span><span class="n">HasKeyboardHandlerComponents</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 16</span><span class="w">  </span><span class="n">EmberQuestGame</span><span class="p">();</span>
<span class="linenos"> 17</span>
<span class="linenos"> 18</span><span class="w">  </span><span class="kd">late</span><span class="w"> </span><span class="n">EmberPlayer</span><span class="w"> </span><span class="n">_ember</span><span class="p">;</span>
<span class="linenos"> 19</span><span class="w">  </span><span class="kd">late</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lastBlockXPosition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.0</span><span class="p">;</span>
<span class="linenos"> 20</span><span class="w">  </span><span class="kd">late</span><span class="w"> </span><span class="n">UniqueKey</span><span class="w"> </span><span class="n">lastBlockKey</span><span class="p">;</span>
<span class="linenos"> 21</span>
<span class="linenos"> 22</span><span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">starsCollected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<span class="linenos"> 23</span><span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">health</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">;</span>
<span class="linenos"> 24</span><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">cloudSpeed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.0</span><span class="p">;</span>
<span class="linenos"> 25</span><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">objectSpeed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.0</span><span class="p">;</span>
<span class="linenos"> 26</span>
<span class="linenos"> 27</span><span class="w">  </span><span class="nd">@override</span>
<span class="linenos"> 28</span><span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">onLoad</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 29</span><span class="w">    </span><span class="c1">//debugMode = true; // Uncomment to see the bounding boxes</span>
<span class="linenos"> 30</span><span class="w">    </span><span class="kd">await</span><span class="w"> </span><span class="n">images</span><span class="p">.</span><span class="n">loadAll</span><span class="p">([</span>
<span class="linenos"> 31</span><span class="w">      </span><span class="s1">&#39;block.png&#39;</span><span class="p">,</span>
<span class="linenos"> 32</span><span class="w">      </span><span class="s1">&#39;ember.png&#39;</span><span class="p">,</span>
<span class="linenos"> 33</span><span class="w">      </span><span class="s1">&#39;ground.png&#39;</span><span class="p">,</span>
<span class="linenos"> 34</span><span class="w">      </span><span class="s1">&#39;heart_half.png&#39;</span><span class="p">,</span>
<span class="linenos"> 35</span><span class="w">      </span><span class="s1">&#39;heart.png&#39;</span><span class="p">,</span>
<span class="linenos"> 36</span><span class="w">      </span><span class="s1">&#39;star.png&#39;</span><span class="p">,</span>
<span class="linenos"> 37</span><span class="w">      </span><span class="s1">&#39;water_enemy.png&#39;</span><span class="p">,</span>
<span class="linenos"> 38</span><span class="w">    </span><span class="p">]);</span>
<span class="linenos"> 39</span><span class="w">    </span><span class="n">camera</span><span class="p">.</span><span class="n">viewfinder</span><span class="p">.</span><span class="n">anchor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Anchor</span><span class="p">.</span><span class="n">topLeft</span><span class="p">;</span>
<span class="linenos"> 40</span>
<span class="linenos"> 41</span><span class="w">    </span><span class="n">initializeGame</span><span class="p">(</span><span class="nl">loadHud:</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
<span class="linenos"> 42</span><span class="w">  </span><span class="p">}</span>
<span class="linenos"> 43</span>
<span class="linenos"> 44</span><span class="w">  </span><span class="nd">@override</span>
<span class="linenos"> 45</span><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">update</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">dt</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 46</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">health</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 47</span><span class="w">      </span><span class="n">overlays</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;GameOver&#39;</span><span class="p">);</span>
<span class="linenos"> 48</span><span class="w">    </span><span class="p">}</span>
<span class="linenos"> 49</span><span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">dt</span><span class="p">);</span>
<span class="linenos"> 50</span><span class="w">  </span><span class="p">}</span>
<span class="linenos"> 51</span>
<span class="linenos"> 52</span><span class="w">  </span><span class="nd">@override</span>
<span class="linenos"> 53</span><span class="w">  </span><span class="n">Color</span><span class="w"> </span><span class="n">backgroundColor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 54</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="n">fromARGB</span><span class="p">(</span><span class="m">255</span><span class="p">,</span><span class="w"> </span><span class="m">173</span><span class="p">,</span><span class="w"> </span><span class="m">223</span><span class="p">,</span><span class="w"> </span><span class="m">247</span><span class="p">);</span>
<span class="linenos"> 55</span><span class="w">  </span><span class="p">}</span>
<span class="linenos"> 56</span>
<span class="linenos"> 57</span><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">loadGameSegments</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">segmentIndex</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">xPositionOffset</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 58</span><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">final</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">segments</span><span class="p">[</span><span class="n">segmentIndex</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 59</span><span class="w">      </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">block</span><span class="p">.</span><span class="n">blockType</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 60</span><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="nl">GroundBlock:</span>
<span class="linenos"> 61</span><span class="w">          </span><span class="n">world</span><span class="p">.</span><span class="n">add</span><span class="p">(</span>
<span class="linenos"> 62</span><span class="w">            </span><span class="n">GroundBlock</span><span class="p">(</span>
<span class="linenos"> 63</span><span class="w">              </span><span class="nl">gridPosition:</span><span class="w"> </span><span class="n">block</span><span class="p">.</span><span class="n">gridPosition</span><span class="p">,</span>
<span class="linenos"> 64</span><span class="w">              </span><span class="nl">xOffset:</span><span class="w"> </span><span class="n">xPositionOffset</span><span class="p">,</span>
<span class="linenos"> 65</span><span class="w">            </span><span class="p">),</span>
<span class="linenos"> 66</span><span class="w">          </span><span class="p">);</span>
<span class="linenos"> 67</span><span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="linenos"> 68</span><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="nl">PlatformBlock:</span>
<span class="linenos"> 69</span><span class="w">          </span><span class="n">world</span><span class="p">.</span><span class="n">add</span><span class="p">(</span>
<span class="linenos"> 70</span><span class="w">            </span><span class="n">PlatformBlock</span><span class="p">(</span>
<span class="linenos"> 71</span><span class="w">              </span><span class="nl">gridPosition:</span><span class="w"> </span><span class="n">block</span><span class="p">.</span><span class="n">gridPosition</span><span class="p">,</span>
<span class="linenos"> 72</span><span class="w">              </span><span class="nl">xOffset:</span><span class="w"> </span><span class="n">xPositionOffset</span><span class="p">,</span>
<span class="linenos"> 73</span><span class="w">            </span><span class="p">),</span>
<span class="linenos"> 74</span><span class="w">          </span><span class="p">);</span>
<span class="linenos"> 75</span><span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="linenos"> 76</span><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="nl">Star:</span>
<span class="linenos"> 77</span><span class="w">          </span><span class="n">world</span><span class="p">.</span><span class="n">add</span><span class="p">(</span>
<span class="linenos"> 78</span><span class="w">            </span><span class="n">Star</span><span class="p">(</span>
<span class="linenos"> 79</span><span class="w">              </span><span class="nl">gridPosition:</span><span class="w"> </span><span class="n">block</span><span class="p">.</span><span class="n">gridPosition</span><span class="p">,</span>
<span class="linenos"> 80</span><span class="w">              </span><span class="nl">xOffset:</span><span class="w"> </span><span class="n">xPositionOffset</span><span class="p">,</span>
<span class="linenos"> 81</span><span class="w">            </span><span class="p">),</span>
<span class="linenos"> 82</span><span class="w">          </span><span class="p">);</span>
<span class="linenos"> 83</span><span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="linenos"> 84</span><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="nl">WaterEnemy:</span>
<span class="linenos"> 85</span><span class="w">          </span><span class="n">world</span><span class="p">.</span><span class="n">add</span><span class="p">(</span>
<span class="linenos"> 86</span><span class="w">            </span><span class="n">WaterEnemy</span><span class="p">(</span>
<span class="linenos"> 87</span><span class="w">              </span><span class="nl">gridPosition:</span><span class="w"> </span><span class="n">block</span><span class="p">.</span><span class="n">gridPosition</span><span class="p">,</span>
<span class="linenos"> 88</span><span class="w">              </span><span class="nl">xOffset:</span><span class="w"> </span><span class="n">xPositionOffset</span><span class="p">,</span>
<span class="linenos"> 89</span><span class="w">            </span><span class="p">),</span>
<span class="linenos"> 90</span><span class="w">          </span><span class="p">);</span>
<span class="linenos"> 91</span><span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="linenos"> 92</span><span class="w">      </span><span class="p">}</span>
<span class="linenos"> 93</span><span class="w">    </span><span class="p">}</span>
<span class="linenos"> 94</span><span class="w">  </span><span class="p">}</span>
<span class="linenos"> 95</span>
<span class="linenos"> 96</span><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">initializeGame</span><span class="p">({</span><span class="kd">required</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">loadHud</span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 97</span><span class="w">    </span><span class="c1">// Assume that size.x &lt; 3200</span>
<span class="linenos"> 98</span><span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">segmentsToLoad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">size</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">640</span><span class="p">).</span><span class="n">ceil</span><span class="p">();</span>
<span class="linenos"> 99</span><span class="w">    </span><span class="n">segmentsToLoad</span><span class="p">.</span><span class="n">clamp</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">segments</span><span class="p">.</span><span class="n">length</span><span class="p">);</span>
<span class="linenos">100</span>
<span class="linenos">101</span><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">segmentsToLoad</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">102</span><span class="w">      </span><span class="n">loadGameSegments</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="m">640</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i</span><span class="p">).</span><span class="n">toDouble</span><span class="p">());</span>
<span class="linenos">103</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">104</span>
<span class="linenos">105</span><span class="w">    </span><span class="n">_ember</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EmberPlayer</span><span class="p">(</span>
<span class="linenos">106</span><span class="w">      </span><span class="nl">position:</span><span class="w"> </span><span class="n">Vector2</span><span class="p">(</span><span class="m">128</span><span class="p">,</span><span class="w"> </span><span class="n">canvasSize</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">128</span><span class="p">),</span>
<span class="linenos">107</span><span class="w">    </span><span class="p">);</span>
<span class="linenos">108</span><span class="w">    </span><span class="n">world</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">_ember</span><span class="p">);</span>
<span class="linenos">109</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">loadHud</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">110</span><span class="w">      </span><span class="n">camera</span><span class="p">.</span><span class="n">viewport</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Hud</span><span class="p">());</span>
<span class="linenos">111</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">112</span><span class="w">  </span><span class="p">}</span>
<span class="linenos">113</span>
<span class="linenos">114</span><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">reset</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">115</span><span class="w">    </span><span class="n">starsCollected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<span class="linenos">116</span><span class="w">    </span><span class="n">health</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">;</span>
<span class="linenos">117</span><span class="w">    </span><span class="n">initializeGame</span><span class="p">(</span><span class="nl">loadHud:</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
<span class="linenos">118</span><span class="w">  </span><span class="p">}</span>
<span class="linenos">119</span><span class="p">}</span>
</pre></div>
</div>
<div class="filename docutils container">
main.dart</div>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flame/game.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 2</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/material.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;ember_quest.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 5</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;overlays/game_over.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 6</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;overlays/main_menu.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="kt">void</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 9</span><span class="w">  </span><span class="n">runApp</span><span class="p">(</span>
<span class="linenos">10</span><span class="w">    </span><span class="n">GameWidget</span><span class="o">&lt;</span><span class="n">EmberQuestGame</span><span class="o">&gt;</span><span class="p">.</span><span class="n">controlled</span><span class="p">(</span>
<span class="linenos">11</span><span class="w">      </span><span class="nl">gameFactory:</span><span class="w"> </span><span class="n">EmberQuestGame</span><span class="p">.</span><span class="k">new</span><span class="p">,</span>
<span class="linenos">12</span><span class="w">      </span><span class="nl">overlayBuilderMap:</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">13</span><span class="w">        </span><span class="s1">&#39;MainMenu&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">game</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">MainMenu</span><span class="p">(</span><span class="nl">game:</span><span class="w"> </span><span class="n">game</span><span class="p">),</span>
<span class="linenos">14</span><span class="w">        </span><span class="s1">&#39;GameOver&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">game</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">GameOver</span><span class="p">(</span><span class="nl">game:</span><span class="w"> </span><span class="n">game</span><span class="p">),</span>
<span class="linenos">15</span><span class="w">      </span><span class="p">},</span>
<span class="linenos">16</span><span class="w">      </span><span class="nl">initialActiveOverlays:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;MainMenu&#39;</span><span class="p">],</span>
<span class="linenos">17</span><span class="w">    </span><span class="p">),</span>
<span class="linenos">18</span><span class="w">  </span><span class="p">);</span>
<span class="linenos">19</span><span class="p">}</span>
</pre></div>
</div>
<div class="filename docutils container">
managers/segment_manager.dart</div>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flame/components.dart&#39;</span><span class="p">;</span>
<span class="linenos">  2</span>
<span class="linenos">  3</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;../actors/water_enemy.dart&#39;</span><span class="p">;</span>
<span class="linenos">  4</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;../objects/ground_block.dart&#39;</span><span class="p">;</span>
<span class="linenos">  5</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;../objects/platform_block.dart&#39;</span><span class="p">;</span>
<span class="linenos">  6</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;../objects/star.dart&#39;</span><span class="p">;</span>
<span class="linenos">  7</span>
<span class="linenos">  8</span><span class="kd">class</span><span class="w"> </span><span class="nc">Block</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">  9</span><span class="w">  </span><span class="c1">// gridPosition position is always segment based X,Y.</span>
<span class="linenos"> 10</span><span class="w">  </span><span class="c1">// 0,0 is the bottom left corner.</span>
<span class="linenos"> 11</span><span class="w">  </span><span class="c1">// 10,10 is the upper right corner.</span>
<span class="linenos"> 12</span><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Vector2</span><span class="w"> </span><span class="n">gridPosition</span><span class="p">;</span>
<span class="linenos"> 13</span><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Type</span><span class="w"> </span><span class="n">blockType</span><span class="p">;</span>
<span class="linenos"> 14</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">gridPosition</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">blockType</span><span class="p">);</span>
<span class="linenos"> 15</span><span class="p">}</span>
<span class="linenos"> 16</span>
<span class="linenos"> 17</span><span class="kd">final</span><span class="w"> </span><span class="n">segments</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="linenos"> 18</span><span class="w">  </span><span class="n">segment0</span><span class="p">,</span>
<span class="linenos"> 19</span><span class="w">  </span><span class="n">segment1</span><span class="p">,</span>
<span class="linenos"> 20</span><span class="w">  </span><span class="n">segment2</span><span class="p">,</span>
<span class="linenos"> 21</span><span class="w">  </span><span class="n">segment3</span><span class="p">,</span>
<span class="linenos"> 22</span><span class="w">  </span><span class="n">segment4</span><span class="p">,</span>
<span class="linenos"> 23</span><span class="p">];</span>
<span class="linenos"> 24</span>
<span class="linenos"> 25</span><span class="kd">final</span><span class="w"> </span><span class="n">segment0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="linenos"> 26</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos"> 27</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos"> 28</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos"> 29</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos"> 30</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos"> 31</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos"> 32</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">WaterEnemy</span><span class="p">),</span>
<span class="linenos"> 33</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="n">PlatformBlock</span><span class="p">),</span>
<span class="linenos"> 34</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos"> 35</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="n">PlatformBlock</span><span class="p">),</span>
<span class="linenos"> 36</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos"> 37</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="n">PlatformBlock</span><span class="p">),</span>
<span class="linenos"> 38</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos"> 39</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="n">PlatformBlock</span><span class="p">),</span>
<span class="linenos"> 40</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">9</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos"> 41</span><span class="p">];</span>
<span class="linenos"> 42</span>
<span class="linenos"> 43</span><span class="kd">final</span><span class="w"> </span><span class="n">segment1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="linenos"> 44</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos"> 45</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos"> 46</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">PlatformBlock</span><span class="p">),</span>
<span class="linenos"> 47</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">PlatformBlock</span><span class="p">),</span>
<span class="linenos"> 48</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="n">PlatformBlock</span><span class="p">),</span>
<span class="linenos"> 49</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">),</span><span class="w"> </span><span class="n">PlatformBlock</span><span class="p">),</span>
<span class="linenos"> 50</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">),</span><span class="w"> </span><span class="n">PlatformBlock</span><span class="p">),</span>
<span class="linenos"> 51</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">),</span><span class="w"> </span><span class="n">PlatformBlock</span><span class="p">),</span>
<span class="linenos"> 52</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">),</span><span class="w"> </span><span class="n">PlatformBlock</span><span class="p">),</span>
<span class="linenos"> 53</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="m">7</span><span class="p">),</span><span class="w"> </span><span class="n">Star</span><span class="p">),</span>
<span class="linenos"> 54</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos"> 55</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">PlatformBlock</span><span class="p">),</span>
<span class="linenos"> 56</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">),</span><span class="w"> </span><span class="n">PlatformBlock</span><span class="p">),</span>
<span class="linenos"> 57</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">),</span><span class="w"> </span><span class="n">WaterEnemy</span><span class="p">),</span>
<span class="linenos"> 58</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">9</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos"> 59</span><span class="p">];</span>
<span class="linenos"> 60</span>
<span class="linenos"> 61</span><span class="kd">final</span><span class="w"> </span><span class="n">segment2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="linenos"> 62</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos"> 63</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos"> 64</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos"> 65</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos"> 66</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="n">PlatformBlock</span><span class="p">),</span>
<span class="linenos"> 67</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos"> 68</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="n">PlatformBlock</span><span class="p">),</span>
<span class="linenos"> 69</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos"> 70</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="n">PlatformBlock</span><span class="p">),</span>
<span class="linenos"> 71</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="n">WaterEnemy</span><span class="p">),</span>
<span class="linenos"> 72</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos"> 73</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="n">PlatformBlock</span><span class="p">),</span>
<span class="linenos"> 74</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="n">PlatformBlock</span><span class="p">),</span>
<span class="linenos"> 75</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">),</span><span class="w"> </span><span class="n">PlatformBlock</span><span class="p">),</span>
<span class="linenos"> 76</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">7</span><span class="p">),</span><span class="w"> </span><span class="n">Star</span><span class="p">),</span>
<span class="linenos"> 77</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos"> 78</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos"> 79</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">9</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos"> 80</span><span class="p">];</span>
<span class="linenos"> 81</span>
<span class="linenos"> 82</span><span class="kd">final</span><span class="w"> </span><span class="n">segment3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="linenos"> 83</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos"> 84</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos"> 85</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">WaterEnemy</span><span class="p">),</span>
<span class="linenos"> 86</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos"> 87</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">PlatformBlock</span><span class="p">),</span>
<span class="linenos"> 88</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">PlatformBlock</span><span class="p">),</span>
<span class="linenos"> 89</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="n">PlatformBlock</span><span class="p">),</span>
<span class="linenos"> 90</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">),</span><span class="w"> </span><span class="n">PlatformBlock</span><span class="p">),</span>
<span class="linenos"> 91</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos"> 92</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">PlatformBlock</span><span class="p">),</span>
<span class="linenos"> 93</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos"> 94</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="m">8</span><span class="p">),</span><span class="w"> </span><span class="n">Star</span><span class="p">),</span>
<span class="linenos"> 95</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">9</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos"> 96</span><span class="p">];</span>
<span class="linenos"> 97</span>
<span class="linenos"> 98</span><span class="kd">final</span><span class="w"> </span><span class="n">segment4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="linenos"> 99</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos">100</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos">101</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos">102</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="n">PlatformBlock</span><span class="p">),</span>
<span class="linenos">103</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos">104</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">WaterEnemy</span><span class="p">),</span>
<span class="linenos">105</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="n">PlatformBlock</span><span class="p">),</span>
<span class="linenos">106</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos">107</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos">108</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">),</span><span class="w"> </span><span class="n">PlatformBlock</span><span class="p">),</span>
<span class="linenos">109</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos">110</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">),</span><span class="w"> </span><span class="n">PlatformBlock</span><span class="p">),</span>
<span class="linenos">111</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">7</span><span class="p">),</span><span class="w"> </span><span class="n">Star</span><span class="p">),</span>
<span class="linenos">112</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos">113</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos">114</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="n">PlatformBlock</span><span class="p">),</span>
<span class="linenos">115</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">9</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">GroundBlock</span><span class="p">),</span>
<span class="linenos">116</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">9</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">WaterEnemy</span><span class="p">),</span>
<span class="linenos">117</span><span class="w">  </span><span class="n">Block</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(</span><span class="m">9</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="n">PlatformBlock</span><span class="p">),</span>
<span class="linenos">118</span><span class="p">];</span>
</pre></div>
</div>
<div class="filename docutils container">
objects/ground_block.dart</div>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;dart:math&#39;</span><span class="p">;</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flame/collisions.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 4</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flame/components.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 5</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/material.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;../ember_quest.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 8</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;../managers/segment_manager.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="kd">class</span><span class="w"> </span><span class="nc">GroundBlock</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">SpriteComponent</span>
<span class="linenos">11</span><span class="w">    </span><span class="kd">with</span><span class="w"> </span><span class="n">HasGameReference</span><span class="o">&lt;</span><span class="n">EmberQuestGame</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">12</span><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Vector2</span><span class="w"> </span><span class="n">gridPosition</span><span class="p">;</span>
<span class="linenos">13</span><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">xOffset</span><span class="p">;</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">UniqueKey</span><span class="w"> </span><span class="n">_blockKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UniqueKey</span><span class="p">();</span>
<span class="linenos">16</span><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Vector2</span><span class="w"> </span><span class="n">velocity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Vector2</span><span class="p">.</span><span class="n">zero</span><span class="p">();</span>
<span class="linenos">17</span>
<span class="linenos">18</span><span class="w">  </span><span class="n">GroundBlock</span><span class="p">({</span>
<span class="linenos">19</span><span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">gridPosition</span><span class="p">,</span>
<span class="linenos">20</span><span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">xOffset</span><span class="p">,</span>
<span class="linenos">21</span><span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">size:</span><span class="w"> </span><span class="n">Vector2</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">64</span><span class="p">),</span><span class="w"> </span><span class="nl">anchor:</span><span class="w"> </span><span class="n">Anchor</span><span class="p">.</span><span class="n">bottomLeft</span><span class="p">);</span>
<span class="linenos">22</span>
<span class="linenos">23</span><span class="w">  </span><span class="nd">@override</span>
<span class="linenos">24</span><span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">onLoad</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">25</span><span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">groundImage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">game</span><span class="p">.</span><span class="n">images</span><span class="p">.</span><span class="n">fromCache</span><span class="p">(</span><span class="s1">&#39;ground.png&#39;</span><span class="p">);</span>
<span class="linenos">26</span><span class="w">    </span><span class="n">sprite</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sprite</span><span class="p">(</span><span class="n">groundImage</span><span class="p">);</span>
<span class="linenos">27</span><span class="w">    </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Vector2</span><span class="p">(</span>
<span class="linenos">28</span><span class="w">      </span><span class="p">(</span><span class="n">gridPosition</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">size</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xOffset</span><span class="p">,</span>
<span class="linenos">29</span><span class="w">      </span><span class="n">game</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">gridPosition</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">size</span><span class="p">.</span><span class="n">y</span><span class="p">),</span>
<span class="linenos">30</span><span class="w">    </span><span class="p">);</span>
<span class="linenos">31</span><span class="w">    </span><span class="n">add</span><span class="p">(</span><span class="n">RectangleHitbox</span><span class="p">(</span><span class="nl">collisionType:</span><span class="w"> </span><span class="n">CollisionType</span><span class="p">.</span><span class="n">passive</span><span class="p">));</span>
<span class="linenos">32</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">gridPosition</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">9</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">position</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">game</span><span class="p">.</span><span class="n">lastBlockXPosition</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">33</span><span class="w">      </span><span class="n">game</span><span class="p">.</span><span class="n">lastBlockKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_blockKey</span><span class="p">;</span>
<span class="linenos">34</span><span class="w">      </span><span class="n">game</span><span class="p">.</span><span class="n">lastBlockXPosition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">position</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">size</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
<span class="linenos">35</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">36</span><span class="w">  </span><span class="p">}</span>
<span class="linenos">37</span>
<span class="linenos">38</span><span class="w">  </span><span class="nd">@override</span>
<span class="linenos">39</span><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">update</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">dt</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">40</span><span class="w">    </span><span class="n">velocity</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">game</span><span class="p">.</span><span class="n">objectSpeed</span><span class="p">;</span>
<span class="linenos">41</span><span class="w">    </span><span class="n">position</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">velocity</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dt</span><span class="p">;</span>
<span class="linenos">42</span>
<span class="linenos">43</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">position</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="o">-</span><span class="n">size</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">44</span><span class="w">      </span><span class="n">removeFromParent</span><span class="p">();</span>
<span class="linenos">45</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">gridPosition</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">46</span><span class="w">        </span><span class="n">game</span><span class="p">.</span><span class="n">loadGameSegments</span><span class="p">(</span>
<span class="linenos">47</span><span class="w">          </span><span class="n">Random</span><span class="p">().</span><span class="n">nextInt</span><span class="p">(</span><span class="n">segments</span><span class="p">.</span><span class="n">length</span><span class="p">),</span>
<span class="linenos">48</span><span class="w">          </span><span class="n">game</span><span class="p">.</span><span class="n">lastBlockXPosition</span><span class="p">,</span>
<span class="linenos">49</span><span class="w">        </span><span class="p">);</span>
<span class="linenos">50</span><span class="w">      </span><span class="p">}</span>
<span class="linenos">51</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">52</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">gridPosition</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">9</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">53</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">game</span><span class="p">.</span><span class="n">lastBlockKey</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">_blockKey</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">54</span><span class="w">        </span><span class="n">game</span><span class="p">.</span><span class="n">lastBlockXPosition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">position</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">size</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">10</span><span class="p">;</span>
<span class="linenos">55</span><span class="w">      </span><span class="p">}</span>
<span class="linenos">56</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">57</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">game</span><span class="p">.</span><span class="n">health</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">58</span><span class="w">      </span><span class="n">removeFromParent</span><span class="p">();</span>
<span class="linenos">59</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">60</span>
<span class="linenos">61</span><span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">dt</span><span class="p">);</span>
<span class="linenos">62</span><span class="w">  </span><span class="p">}</span>
<span class="linenos">63</span><span class="p">}</span>
</pre></div>
</div>
<div class="filename docutils container">
objects/platform_block.dart</div>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flame/collisions.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 2</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flame/components.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;../ember_quest.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="kd">class</span><span class="w"> </span><span class="nc">PlatformBlock</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">SpriteComponent</span>
<span class="linenos"> 7</span><span class="w">    </span><span class="kd">with</span><span class="w"> </span><span class="n">HasGameReference</span><span class="o">&lt;</span><span class="n">EmberQuestGame</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 8</span><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Vector2</span><span class="w"> </span><span class="n">gridPosition</span><span class="p">;</span>
<span class="linenos"> 9</span><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">xOffset</span><span class="p">;</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Vector2</span><span class="w"> </span><span class="n">velocity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Vector2</span><span class="p">.</span><span class="n">zero</span><span class="p">();</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="w">  </span><span class="n">PlatformBlock</span><span class="p">({</span>
<span class="linenos">14</span><span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">gridPosition</span><span class="p">,</span>
<span class="linenos">15</span><span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">xOffset</span><span class="p">,</span>
<span class="linenos">16</span><span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">size:</span><span class="w"> </span><span class="n">Vector2</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">64</span><span class="p">),</span><span class="w"> </span><span class="nl">anchor:</span><span class="w"> </span><span class="n">Anchor</span><span class="p">.</span><span class="n">bottomLeft</span><span class="p">);</span>
<span class="linenos">17</span>
<span class="linenos">18</span><span class="w">  </span><span class="nd">@override</span>
<span class="linenos">19</span><span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">onLoad</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">20</span><span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">platformImage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">game</span><span class="p">.</span><span class="n">images</span><span class="p">.</span><span class="n">fromCache</span><span class="p">(</span><span class="s1">&#39;block.png&#39;</span><span class="p">);</span>
<span class="linenos">21</span><span class="w">    </span><span class="n">sprite</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sprite</span><span class="p">(</span><span class="n">platformImage</span><span class="p">);</span>
<span class="linenos">22</span><span class="w">    </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Vector2</span><span class="p">(</span>
<span class="linenos">23</span><span class="w">      </span><span class="p">(</span><span class="n">gridPosition</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">size</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xOffset</span><span class="p">,</span>
<span class="linenos">24</span><span class="w">      </span><span class="n">game</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">gridPosition</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">size</span><span class="p">.</span><span class="n">y</span><span class="p">),</span>
<span class="linenos">25</span><span class="w">    </span><span class="p">);</span>
<span class="linenos">26</span><span class="w">    </span><span class="n">add</span><span class="p">(</span><span class="n">RectangleHitbox</span><span class="p">(</span><span class="nl">collisionType:</span><span class="w"> </span><span class="n">CollisionType</span><span class="p">.</span><span class="n">passive</span><span class="p">));</span>
<span class="linenos">27</span><span class="w">  </span><span class="p">}</span>
<span class="linenos">28</span>
<span class="linenos">29</span><span class="w">  </span><span class="nd">@override</span>
<span class="linenos">30</span><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">update</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">dt</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">31</span><span class="w">    </span><span class="n">velocity</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">game</span><span class="p">.</span><span class="n">objectSpeed</span><span class="p">;</span>
<span class="linenos">32</span><span class="w">    </span><span class="n">position</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">velocity</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dt</span><span class="p">;</span>
<span class="linenos">33</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">position</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="o">-</span><span class="n">size</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">game</span><span class="p">.</span><span class="n">health</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">34</span><span class="w">      </span><span class="n">removeFromParent</span><span class="p">();</span>
<span class="linenos">35</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">36</span><span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">dt</span><span class="p">);</span>
<span class="linenos">37</span><span class="w">  </span><span class="p">}</span>
<span class="linenos">38</span><span class="p">}</span>
</pre></div>
</div>
<div class="filename docutils container">
objects/star.dart</div>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flame/collisions.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 2</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flame/components.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 3</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flame/effects.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 4</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/material.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;../ember_quest.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="kd">class</span><span class="w"> </span><span class="nc">Star</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">SpriteComponent</span><span class="w"> </span><span class="kd">with</span><span class="w"> </span><span class="n">HasGameReference</span><span class="o">&lt;</span><span class="n">EmberQuestGame</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 9</span><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Vector2</span><span class="w"> </span><span class="n">gridPosition</span><span class="p">;</span>
<span class="linenos">10</span><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">xOffset</span><span class="p">;</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">Vector2</span><span class="w"> </span><span class="n">velocity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Vector2</span><span class="p">.</span><span class="n">zero</span><span class="p">();</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="w">  </span><span class="n">Star</span><span class="p">({</span>
<span class="linenos">15</span><span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">gridPosition</span><span class="p">,</span>
<span class="linenos">16</span><span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">xOffset</span><span class="p">,</span>
<span class="linenos">17</span><span class="w">  </span><span class="p">})</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">super</span><span class="p">(</span><span class="nl">size:</span><span class="w"> </span><span class="n">Vector2</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">64</span><span class="p">),</span><span class="w"> </span><span class="nl">anchor:</span><span class="w"> </span><span class="n">Anchor</span><span class="p">.</span><span class="n">center</span><span class="p">);</span>
<span class="linenos">18</span>
<span class="linenos">19</span><span class="w">  </span><span class="nd">@override</span>
<span class="linenos">20</span><span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">onLoad</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">21</span><span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">starImage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">game</span><span class="p">.</span><span class="n">images</span><span class="p">.</span><span class="n">fromCache</span><span class="p">(</span><span class="s1">&#39;star.png&#39;</span><span class="p">);</span>
<span class="linenos">22</span><span class="w">    </span><span class="n">sprite</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sprite</span><span class="p">(</span><span class="n">starImage</span><span class="p">);</span>
<span class="linenos">23</span><span class="w">    </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Vector2</span><span class="p">(</span>
<span class="linenos">24</span><span class="w">      </span><span class="p">(</span><span class="n">gridPosition</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">size</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xOffset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">size</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">2</span><span class="p">),</span>
<span class="linenos">25</span><span class="w">      </span><span class="n">game</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">gridPosition</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">size</span><span class="p">.</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">size</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">2</span><span class="p">),</span>
<span class="linenos">26</span><span class="w">    </span><span class="p">);</span>
<span class="linenos">27</span><span class="w">    </span><span class="n">add</span><span class="p">(</span><span class="n">RectangleHitbox</span><span class="p">(</span><span class="nl">collisionType:</span><span class="w"> </span><span class="n">CollisionType</span><span class="p">.</span><span class="n">passive</span><span class="p">));</span>
<span class="linenos">28</span><span class="w">    </span><span class="n">add</span><span class="p">(</span>
<span class="linenos">29</span><span class="w">      </span><span class="n">SizeEffect</span><span class="p">.</span><span class="n">by</span><span class="p">(</span>
<span class="linenos">30</span><span class="w">        </span><span class="n">Vector2</span><span class="p">(</span><span class="o">-</span><span class="m">24</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="m">24</span><span class="p">),</span>
<span class="linenos">31</span><span class="w">        </span><span class="n">EffectController</span><span class="p">(</span>
<span class="linenos">32</span><span class="w">          </span><span class="nl">duration:</span><span class="w"> </span><span class="p">.</span><span class="m">75</span><span class="p">,</span>
<span class="linenos">33</span><span class="w">          </span><span class="nl">reverseDuration:</span><span class="w"> </span><span class="p">.</span><span class="m">5</span><span class="p">,</span>
<span class="linenos">34</span><span class="w">          </span><span class="nl">infinite:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="linenos">35</span><span class="w">          </span><span class="nl">curve:</span><span class="w"> </span><span class="n">Curves</span><span class="p">.</span><span class="n">easeOut</span><span class="p">,</span>
<span class="linenos">36</span><span class="w">        </span><span class="p">),</span>
<span class="linenos">37</span><span class="w">      </span><span class="p">),</span>
<span class="linenos">38</span><span class="w">    </span><span class="p">);</span>
<span class="linenos">39</span><span class="w">  </span><span class="p">}</span>
<span class="linenos">40</span>
<span class="linenos">41</span><span class="w">  </span><span class="nd">@override</span>
<span class="linenos">42</span><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">update</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">dt</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">43</span><span class="w">    </span><span class="n">velocity</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">game</span><span class="p">.</span><span class="n">objectSpeed</span><span class="p">;</span>
<span class="linenos">44</span><span class="w">    </span><span class="n">position</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">velocity</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dt</span><span class="p">;</span>
<span class="linenos">45</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">position</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="o">-</span><span class="n">size</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">game</span><span class="p">.</span><span class="n">health</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">46</span><span class="w">      </span><span class="n">removeFromParent</span><span class="p">();</span>
<span class="linenos">47</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">48</span><span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">dt</span><span class="p">);</span>
<span class="linenos">49</span><span class="w">  </span><span class="p">}</span>
<span class="linenos">50</span><span class="p">}</span>
</pre></div>
</div>
<div class="filename docutils container">
overlays/game_over.dart</div>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/material.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;../ember_quest.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="kd">class</span><span class="w"> </span><span class="nc">GameOver</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 6</span><span class="w">  </span><span class="c1">// Reference to parent game.</span>
<span class="linenos"> 7</span><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">EmberQuestGame</span><span class="w"> </span><span class="n">game</span><span class="p">;</span>
<span class="linenos"> 8</span><span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">GameOver</span><span class="p">({</span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">game</span><span class="p">,</span><span class="w"> </span><span class="k">super</span><span class="p">.</span><span class="n">key</span><span class="p">});</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="w">  </span><span class="nd">@override</span>
<span class="linenos">11</span><span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">12</span><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">blackTextColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="n">fromRGBO</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1.0</span><span class="p">);</span>
<span class="linenos">13</span><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">whiteTextColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="n">fromRGBO</span><span class="p">(</span><span class="m">255</span><span class="p">,</span><span class="w"> </span><span class="m">255</span><span class="p">,</span><span class="w"> </span><span class="m">255</span><span class="p">,</span><span class="w"> </span><span class="m">1.0</span><span class="p">);</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Material</span><span class="p">(</span>
<span class="linenos">16</span><span class="w">      </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">transparent</span><span class="p">,</span>
<span class="linenos">17</span><span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span>
<span class="linenos">18</span><span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="linenos">19</span><span class="w">          </span><span class="nl">padding:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">10.0</span><span class="p">),</span>
<span class="linenos">20</span><span class="w">          </span><span class="nl">height:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="linenos">21</span><span class="w">          </span><span class="nl">width:</span><span class="w"> </span><span class="m">300</span><span class="p">,</span>
<span class="linenos">22</span><span class="w">          </span><span class="nl">decoration:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">BoxDecoration</span><span class="p">(</span>
<span class="linenos">23</span><span class="w">            </span><span class="nl">color:</span><span class="w"> </span><span class="n">blackTextColor</span><span class="p">,</span>
<span class="linenos">24</span><span class="w">            </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">all</span><span class="p">(</span>
<span class="linenos">25</span><span class="w">              </span><span class="n">Radius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">20</span><span class="p">),</span>
<span class="linenos">26</span><span class="w">            </span><span class="p">),</span>
<span class="linenos">27</span><span class="w">          </span><span class="p">),</span>
<span class="linenos">28</span><span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="linenos">29</span><span class="w">            </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="linenos">30</span><span class="w">            </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="linenos">31</span><span class="w">              </span><span class="k">const</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="linenos">32</span><span class="w">                </span><span class="s1">&#39;Game Over&#39;</span><span class="p">,</span>
<span class="linenos">33</span><span class="w">                </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="linenos">34</span><span class="w">                  </span><span class="nl">color:</span><span class="w"> </span><span class="n">whiteTextColor</span><span class="p">,</span>
<span class="linenos">35</span><span class="w">                  </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">24</span><span class="p">,</span>
<span class="linenos">36</span><span class="w">                </span><span class="p">),</span>
<span class="linenos">37</span><span class="w">              </span><span class="p">),</span>
<span class="linenos">38</span><span class="w">              </span><span class="k">const</span><span class="w"> </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">40</span><span class="p">),</span>
<span class="linenos">39</span><span class="w">              </span><span class="n">SizedBox</span><span class="p">(</span>
<span class="linenos">40</span><span class="w">                </span><span class="nl">width:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="linenos">41</span><span class="w">                </span><span class="nl">height:</span><span class="w"> </span><span class="m">75</span><span class="p">,</span>
<span class="linenos">42</span><span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="linenos">43</span><span class="w">                  </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">44</span><span class="w">                    </span><span class="n">game</span><span class="p">.</span><span class="n">reset</span><span class="p">();</span>
<span class="linenos">45</span><span class="w">                    </span><span class="n">game</span><span class="p">.</span><span class="n">overlays</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;GameOver&#39;</span><span class="p">);</span>
<span class="linenos">46</span><span class="w">                  </span><span class="p">},</span>
<span class="linenos">47</span><span class="w">                  </span><span class="nl">style:</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">.</span><span class="n">styleFrom</span><span class="p">(</span>
<span class="linenos">48</span><span class="w">                    </span><span class="nl">backgroundColor:</span><span class="w"> </span><span class="n">whiteTextColor</span><span class="p">,</span>
<span class="linenos">49</span><span class="w">                  </span><span class="p">),</span>
<span class="linenos">50</span><span class="w">                  </span><span class="nl">child:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="linenos">51</span><span class="w">                    </span><span class="s1">&#39;Play Again&#39;</span><span class="p">,</span>
<span class="linenos">52</span><span class="w">                    </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="linenos">53</span><span class="w">                      </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">28.0</span><span class="p">,</span>
<span class="linenos">54</span><span class="w">                      </span><span class="nl">color:</span><span class="w"> </span><span class="n">blackTextColor</span><span class="p">,</span>
<span class="linenos">55</span><span class="w">                    </span><span class="p">),</span>
<span class="linenos">56</span><span class="w">                  </span><span class="p">),</span>
<span class="linenos">57</span><span class="w">                </span><span class="p">),</span>
<span class="linenos">58</span><span class="w">              </span><span class="p">),</span>
<span class="linenos">59</span><span class="w">            </span><span class="p">],</span>
<span class="linenos">60</span><span class="w">          </span><span class="p">),</span>
<span class="linenos">61</span><span class="w">        </span><span class="p">),</span>
<span class="linenos">62</span><span class="w">      </span><span class="p">),</span>
<span class="linenos">63</span><span class="w">    </span><span class="p">);</span>
<span class="linenos">64</span><span class="w">  </span><span class="p">}</span>
<span class="linenos">65</span><span class="p">}</span>
</pre></div>
</div>
<div class="filename docutils container">
overlays/heart.dart</div>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flame/components.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;../ember_quest.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="n">enum</span><span class="w"> </span><span class="n">HeartState</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 6</span><span class="w">  </span><span class="n">available</span><span class="p">,</span>
<span class="linenos"> 7</span><span class="w">  </span><span class="n">unavailable</span><span class="p">,</span>
<span class="linenos"> 8</span><span class="p">}</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="kd">class</span><span class="w"> </span><span class="nc">HeartHealthComponent</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">SpriteGroupComponent</span><span class="o">&lt;</span><span class="n">HeartState</span><span class="o">&gt;</span>
<span class="linenos">11</span><span class="w">    </span><span class="kd">with</span><span class="w"> </span><span class="n">HasGameReference</span><span class="o">&lt;</span><span class="n">EmberQuestGame</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">12</span><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">heartNumber</span><span class="p">;</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="w">  </span><span class="n">HeartHealthComponent</span><span class="p">({</span>
<span class="linenos">15</span><span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">heartNumber</span><span class="p">,</span>
<span class="linenos">16</span><span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">super</span><span class="p">.</span><span class="n">position</span><span class="p">,</span>
<span class="linenos">17</span><span class="w">    </span><span class="kd">required</span><span class="w"> </span><span class="k">super</span><span class="p">.</span><span class="n">size</span><span class="p">,</span>
<span class="linenos">18</span><span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">scale</span><span class="p">,</span>
<span class="linenos">19</span><span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">angle</span><span class="p">,</span>
<span class="linenos">20</span><span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">anchor</span><span class="p">,</span>
<span class="linenos">21</span><span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">priority</span><span class="p">,</span>
<span class="linenos">22</span><span class="w">  </span><span class="p">});</span>
<span class="linenos">23</span>
<span class="linenos">24</span><span class="w">  </span><span class="nd">@override</span>
<span class="linenos">25</span><span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">onLoad</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">26</span><span class="w">    </span><span class="kd">await</span><span class="w"> </span><span class="k">super</span><span class="p">.</span><span class="n">onLoad</span><span class="p">();</span>
<span class="linenos">27</span><span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">availableSprite</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">game</span><span class="p">.</span><span class="n">loadSprite</span><span class="p">(</span>
<span class="linenos">28</span><span class="w">      </span><span class="s1">&#39;heart.png&#39;</span><span class="p">,</span>
<span class="linenos">29</span><span class="w">      </span><span class="nl">srcSize:</span><span class="w"> </span><span class="n">Vector2</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">32</span><span class="p">),</span>
<span class="linenos">30</span><span class="w">    </span><span class="p">);</span>
<span class="linenos">31</span>
<span class="linenos">32</span><span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">unavailableSprite</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">game</span><span class="p">.</span><span class="n">loadSprite</span><span class="p">(</span>
<span class="linenos">33</span><span class="w">      </span><span class="s1">&#39;heart_half.png&#39;</span><span class="p">,</span>
<span class="linenos">34</span><span class="w">      </span><span class="nl">srcSize:</span><span class="w"> </span><span class="n">Vector2</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">32</span><span class="p">),</span>
<span class="linenos">35</span><span class="w">    </span><span class="p">);</span>
<span class="linenos">36</span>
<span class="linenos">37</span><span class="w">    </span><span class="n">sprites</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">38</span><span class="w">      </span><span class="n">HeartState</span><span class="p">.</span><span class="nl">available:</span><span class="w"> </span><span class="n">availableSprite</span><span class="p">,</span>
<span class="linenos">39</span><span class="w">      </span><span class="n">HeartState</span><span class="p">.</span><span class="nl">unavailable:</span><span class="w"> </span><span class="n">unavailableSprite</span><span class="p">,</span>
<span class="linenos">40</span><span class="w">    </span><span class="p">};</span>
<span class="linenos">41</span>
<span class="linenos">42</span><span class="w">    </span><span class="n">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HeartState</span><span class="p">.</span><span class="n">available</span><span class="p">;</span>
<span class="linenos">43</span><span class="w">  </span><span class="p">}</span>
<span class="linenos">44</span>
<span class="linenos">45</span><span class="w">  </span><span class="nd">@override</span>
<span class="linenos">46</span><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">update</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">dt</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">47</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">game</span><span class="p">.</span><span class="n">health</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">heartNumber</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">48</span><span class="w">      </span><span class="n">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HeartState</span><span class="p">.</span><span class="n">unavailable</span><span class="p">;</span>
<span class="linenos">49</span><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">50</span><span class="w">      </span><span class="n">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HeartState</span><span class="p">.</span><span class="n">available</span><span class="p">;</span>
<span class="linenos">51</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">52</span><span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">dt</span><span class="p">);</span>
<span class="linenos">53</span><span class="w">  </span><span class="p">}</span>
<span class="linenos">54</span><span class="p">}</span>
</pre></div>
</div>
<div class="filename docutils container">
overlays/hud.dart</div>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flame/components.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 2</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/material.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;../ember_quest.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 5</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;heart.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="kd">class</span><span class="w"> </span><span class="nc">Hud</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">PositionComponent</span><span class="w"> </span><span class="kd">with</span><span class="w"> </span><span class="n">HasGameReference</span><span class="o">&lt;</span><span class="n">EmberQuestGame</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 8</span><span class="w">  </span><span class="n">Hud</span><span class="p">({</span>
<span class="linenos"> 9</span><span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">position</span><span class="p">,</span>
<span class="linenos">10</span><span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">size</span><span class="p">,</span>
<span class="linenos">11</span><span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">scale</span><span class="p">,</span>
<span class="linenos">12</span><span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">angle</span><span class="p">,</span>
<span class="linenos">13</span><span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">anchor</span><span class="p">,</span>
<span class="linenos">14</span><span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">children</span><span class="p">,</span>
<span class="linenos">15</span><span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">priority</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">,</span>
<span class="linenos">16</span><span class="w">  </span><span class="p">});</span>
<span class="linenos">17</span>
<span class="linenos">18</span><span class="w">  </span><span class="kd">late</span><span class="w"> </span><span class="n">TextComponent</span><span class="w"> </span><span class="n">_scoreTextComponent</span><span class="p">;</span>
<span class="linenos">19</span>
<span class="linenos">20</span><span class="w">  </span><span class="nd">@override</span>
<span class="linenos">21</span><span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;?</span><span class="w"> </span><span class="n">onLoad</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">22</span><span class="w">    </span><span class="n">_scoreTextComponent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextComponent</span><span class="p">(</span>
<span class="linenos">23</span><span class="w">      </span><span class="nl">text:</span><span class="w"> </span><span class="s1">&#39;</span><span class="si">${</span><span class="n">game</span><span class="p">.</span><span class="n">starsCollected</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="linenos">24</span><span class="w">      </span><span class="nl">textRenderer:</span><span class="w"> </span><span class="n">TextPaint</span><span class="p">(</span>
<span class="linenos">25</span><span class="w">        </span><span class="nl">style:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="linenos">26</span><span class="w">          </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">32</span><span class="p">,</span>
<span class="linenos">27</span><span class="w">          </span><span class="nl">color:</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="n">fromRGBO</span><span class="p">(</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span>
<span class="linenos">28</span><span class="w">        </span><span class="p">),</span>
<span class="linenos">29</span><span class="w">      </span><span class="p">),</span>
<span class="linenos">30</span><span class="w">      </span><span class="nl">anchor:</span><span class="w"> </span><span class="n">Anchor</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="linenos">31</span><span class="w">      </span><span class="nl">position:</span><span class="w"> </span><span class="n">Vector2</span><span class="p">(</span><span class="n">game</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">60</span><span class="p">,</span><span class="w"> </span><span class="m">20</span><span class="p">),</span>
<span class="linenos">32</span><span class="w">    </span><span class="p">);</span>
<span class="linenos">33</span><span class="w">    </span><span class="n">add</span><span class="p">(</span><span class="n">_scoreTextComponent</span><span class="p">);</span>
<span class="linenos">34</span>
<span class="linenos">35</span><span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">starSprite</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">await</span><span class="w"> </span><span class="n">game</span><span class="p">.</span><span class="n">loadSprite</span><span class="p">(</span><span class="s1">&#39;star.png&#39;</span><span class="p">);</span>
<span class="linenos">36</span><span class="w">    </span><span class="n">add</span><span class="p">(</span>
<span class="linenos">37</span><span class="w">      </span><span class="n">SpriteComponent</span><span class="p">(</span>
<span class="linenos">38</span><span class="w">        </span><span class="nl">sprite:</span><span class="w"> </span><span class="n">starSprite</span><span class="p">,</span>
<span class="linenos">39</span><span class="w">        </span><span class="nl">position:</span><span class="w"> </span><span class="n">Vector2</span><span class="p">(</span><span class="n">game</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="m">20</span><span class="p">),</span>
<span class="linenos">40</span><span class="w">        </span><span class="nl">size:</span><span class="w"> </span><span class="n">Vector2</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">32</span><span class="p">),</span>
<span class="linenos">41</span><span class="w">        </span><span class="nl">anchor:</span><span class="w"> </span><span class="n">Anchor</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="linenos">42</span><span class="w">      </span><span class="p">),</span>
<span class="linenos">43</span><span class="w">    </span><span class="p">);</span>
<span class="linenos">44</span>
<span class="linenos">45</span><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">game</span><span class="p">.</span><span class="n">health</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">46</span><span class="w">      </span><span class="kd">final</span><span class="w"> </span><span class="n">positionX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="linenos">47</span><span class="w">      </span><span class="kd">await</span><span class="w"> </span><span class="n">add</span><span class="p">(</span>
<span class="linenos">48</span><span class="w">        </span><span class="n">HeartHealthComponent</span><span class="p">(</span>
<span class="linenos">49</span><span class="w">          </span><span class="nl">heartNumber:</span><span class="w"> </span><span class="n">i</span><span class="p">,</span>
<span class="linenos">50</span><span class="w">          </span><span class="nl">position:</span><span class="w"> </span><span class="n">Vector2</span><span class="p">(</span><span class="n">positionX</span><span class="p">.</span><span class="n">toDouble</span><span class="p">(),</span><span class="w"> </span><span class="m">20</span><span class="p">),</span>
<span class="linenos">51</span><span class="w">          </span><span class="nl">size:</span><span class="w"> </span><span class="n">Vector2</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">32</span><span class="p">),</span>
<span class="linenos">52</span><span class="w">        </span><span class="p">),</span>
<span class="linenos">53</span><span class="w">      </span><span class="p">);</span>
<span class="linenos">54</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">55</span>
<span class="linenos">56</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">super</span><span class="p">.</span><span class="n">onLoad</span><span class="p">();</span>
<span class="linenos">57</span><span class="w">  </span><span class="p">}</span>
<span class="linenos">58</span>
<span class="linenos">59</span><span class="w">  </span><span class="nd">@override</span>
<span class="linenos">60</span><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">update</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">dt</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">61</span><span class="w">    </span><span class="n">_scoreTextComponent</span><span class="p">.</span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;</span><span class="si">${</span><span class="n">game</span><span class="p">.</span><span class="n">starsCollected</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">;</span>
<span class="linenos">62</span><span class="w">    </span><span class="k">super</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">dt</span><span class="p">);</span>
<span class="linenos">63</span><span class="w">  </span><span class="p">}</span>
<span class="linenos">64</span><span class="p">}</span>
</pre></div>
</div>
<div class="filename docutils container">
overlays/main_menu.dart</div>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;package:flutter/material.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="k">import</span><span class="w"> </span><span class="s1">&#39;../ember_quest.dart&#39;</span><span class="p">;</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="kd">class</span><span class="w"> </span><span class="nc">MainMenu</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">StatelessWidget</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 6</span><span class="w">  </span><span class="c1">// Reference to parent game.</span>
<span class="linenos"> 7</span><span class="w">  </span><span class="kd">final</span><span class="w"> </span><span class="n">EmberQuestGame</span><span class="w"> </span><span class="n">game</span><span class="p">;</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">MainMenu</span><span class="p">({</span><span class="kd">required</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">game</span><span class="p">,</span><span class="w"> </span><span class="k">super</span><span class="p">.</span><span class="n">key</span><span class="p">});</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="w">  </span><span class="nd">@override</span>
<span class="linenos">12</span><span class="w">  </span><span class="n">Widget</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">13</span><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">blackTextColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="n">fromRGBO</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1.0</span><span class="p">);</span>
<span class="linenos">14</span><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">whiteTextColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="n">fromRGBO</span><span class="p">(</span><span class="m">255</span><span class="p">,</span><span class="w"> </span><span class="m">255</span><span class="p">,</span><span class="w"> </span><span class="m">255</span><span class="p">,</span><span class="w"> </span><span class="m">1.0</span><span class="p">);</span>
<span class="linenos">15</span>
<span class="linenos">16</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Material</span><span class="p">(</span>
<span class="linenos">17</span><span class="w">      </span><span class="nl">color:</span><span class="w"> </span><span class="n">Colors</span><span class="p">.</span><span class="n">transparent</span><span class="p">,</span>
<span class="linenos">18</span><span class="w">      </span><span class="nl">child:</span><span class="w"> </span><span class="n">Center</span><span class="p">(</span>
<span class="linenos">19</span><span class="w">        </span><span class="nl">child:</span><span class="w"> </span><span class="n">Container</span><span class="p">(</span>
<span class="linenos">20</span><span class="w">          </span><span class="nl">padding:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">EdgeInsets</span><span class="p">.</span><span class="n">all</span><span class="p">(</span><span class="m">10.0</span><span class="p">),</span>
<span class="linenos">21</span><span class="w">          </span><span class="nl">height:</span><span class="w"> </span><span class="m">250</span><span class="p">,</span>
<span class="linenos">22</span><span class="w">          </span><span class="nl">width:</span><span class="w"> </span><span class="m">300</span><span class="p">,</span>
<span class="linenos">23</span><span class="w">          </span><span class="nl">decoration:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">BoxDecoration</span><span class="p">(</span>
<span class="linenos">24</span><span class="w">            </span><span class="nl">color:</span><span class="w"> </span><span class="n">blackTextColor</span><span class="p">,</span>
<span class="linenos">25</span><span class="w">            </span><span class="nl">borderRadius:</span><span class="w"> </span><span class="n">BorderRadius</span><span class="p">.</span><span class="n">all</span><span class="p">(</span>
<span class="linenos">26</span><span class="w">              </span><span class="n">Radius</span><span class="p">.</span><span class="n">circular</span><span class="p">(</span><span class="m">20</span><span class="p">),</span>
<span class="linenos">27</span><span class="w">            </span><span class="p">),</span>
<span class="linenos">28</span><span class="w">          </span><span class="p">),</span>
<span class="linenos">29</span><span class="w">          </span><span class="nl">child:</span><span class="w"> </span><span class="n">Column</span><span class="p">(</span>
<span class="linenos">30</span><span class="w">            </span><span class="nl">mainAxisAlignment:</span><span class="w"> </span><span class="n">MainAxisAlignment</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="linenos">31</span><span class="w">            </span><span class="nl">children:</span><span class="w"> </span><span class="p">[</span>
<span class="linenos">32</span><span class="w">              </span><span class="k">const</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="linenos">33</span><span class="w">                </span><span class="s1">&#39;Ember Quest&#39;</span><span class="p">,</span>
<span class="linenos">34</span><span class="w">                </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="linenos">35</span><span class="w">                  </span><span class="nl">color:</span><span class="w"> </span><span class="n">whiteTextColor</span><span class="p">,</span>
<span class="linenos">36</span><span class="w">                  </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">24</span><span class="p">,</span>
<span class="linenos">37</span><span class="w">                </span><span class="p">),</span>
<span class="linenos">38</span><span class="w">              </span><span class="p">),</span>
<span class="linenos">39</span><span class="w">              </span><span class="k">const</span><span class="w"> </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">40</span><span class="p">),</span>
<span class="linenos">40</span><span class="w">              </span><span class="n">SizedBox</span><span class="p">(</span>
<span class="linenos">41</span><span class="w">                </span><span class="nl">width:</span><span class="w"> </span><span class="m">200</span><span class="p">,</span>
<span class="linenos">42</span><span class="w">                </span><span class="nl">height:</span><span class="w"> </span><span class="m">75</span><span class="p">,</span>
<span class="linenos">43</span><span class="w">                </span><span class="nl">child:</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">(</span>
<span class="linenos">44</span><span class="w">                  </span><span class="nl">onPressed:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">45</span><span class="w">                    </span><span class="n">game</span><span class="p">.</span><span class="n">overlays</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;MainMenu&#39;</span><span class="p">);</span>
<span class="linenos">46</span><span class="w">                  </span><span class="p">},</span>
<span class="linenos">47</span><span class="w">                  </span><span class="nl">style:</span><span class="w"> </span><span class="n">ElevatedButton</span><span class="p">.</span><span class="n">styleFrom</span><span class="p">(</span>
<span class="linenos">48</span><span class="w">                    </span><span class="nl">backgroundColor:</span><span class="w"> </span><span class="n">whiteTextColor</span><span class="p">,</span>
<span class="linenos">49</span><span class="w">                  </span><span class="p">),</span>
<span class="linenos">50</span><span class="w">                  </span><span class="nl">child:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="linenos">51</span><span class="w">                    </span><span class="s1">&#39;Play&#39;</span><span class="p">,</span>
<span class="linenos">52</span><span class="w">                    </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="linenos">53</span><span class="w">                      </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">40.0</span><span class="p">,</span>
<span class="linenos">54</span><span class="w">                      </span><span class="nl">color:</span><span class="w"> </span><span class="n">blackTextColor</span><span class="p">,</span>
<span class="linenos">55</span><span class="w">                    </span><span class="p">),</span>
<span class="linenos">56</span><span class="w">                  </span><span class="p">),</span>
<span class="linenos">57</span><span class="w">                </span><span class="p">),</span>
<span class="linenos">58</span><span class="w">              </span><span class="p">),</span>
<span class="linenos">59</span><span class="w">              </span><span class="k">const</span><span class="w"> </span><span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span><span class="w"> </span><span class="m">20</span><span class="p">),</span>
<span class="linenos">60</span><span class="w">              </span><span class="k">const</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="linenos">61</span><span class="w">                </span><span class="s1">&#39;&#39;&#39;Use WASD or Arrow Keys for movement.</span>
<span class="linenos">62</span><span class="s1">Space bar to jump.</span>
<span class="linenos">63</span><span class="s1">Collect as many stars as you can and avoid enemies!&#39;&#39;&#39;</span><span class="p">,</span>
<span class="linenos">64</span><span class="w">                </span><span class="nl">textAlign:</span><span class="w"> </span><span class="n">TextAlign</span><span class="p">.</span><span class="n">center</span><span class="p">,</span>
<span class="linenos">65</span><span class="w">                </span><span class="nl">style:</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="linenos">66</span><span class="w">                  </span><span class="nl">color:</span><span class="w"> </span><span class="n">whiteTextColor</span><span class="p">,</span>
<span class="linenos">67</span><span class="w">                  </span><span class="nl">fontSize:</span><span class="w"> </span><span class="m">14</span><span class="p">,</span>
<span class="linenos">68</span><span class="w">                </span><span class="p">),</span>
<span class="linenos">69</span><span class="w">              </span><span class="p">),</span>
<span class="linenos">70</span><span class="w">            </span><span class="p">],</span>
<span class="linenos">71</span><span class="w">          </span><span class="p">),</span>
<span class="linenos">72</span><span class="w">        </span><span class="p">),</span>
<span class="linenos">73</span><span class="w">      </span><span class="p">),</span>
<span class="linenos">74</span><span class="w">    </span><span class="p">);</span>
<span class="linenos">75</span><span class="w">  </span><span class="p">}</span>
<span class="linenos">76</span><span class="p">}</span>
</pre></div>
</div>
</div>
<button class="flutter-app-button code" onclick="open_code_listings(&quot;tutorials-platformer-app-source-&quot;)">Code</button></section>
</section>


    </div>
    <div class="copyright">
      The content on this page is licensed under the <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 License</a>,
      and code samples under the <a href="https://raw.githubusercontent.com/flame-engine/flame/main/LICENSE">MIT License</a>.
    </div>
    <div class="prev-next-area">
      <a class="left-prev" id="prev-link" href="step_6.html" title="previous page">
        <i class="fa fa-angle-left"></i>
        <div class="prev-next-info">
          <p class="prev-next-subtitle">Previous:</p>
          <p class="prev-next-title">6. Adding the HUD</p>
        </div>
      </a>
      <div class='expander'></div>
      <a class="right-next" id="next-link" href="../space_shooter/space_shooter.html" title="next page">
        <div class="prev-next-info">
          <p class="prev-next-subtitle">Next:</p>
          <p class="prev-next-title">Space Shooter Game Tutorial</p>
        </div>
        <i class="fa fa-angle-right"></i>
      </a>
    </div>
  </div>

  <div class="sidebar-right">
    
    <div class="nav-right" role="navigation" aria-label="table of contents">
      <div id='toc-local' class='list-group'>
 <div class='header'><i class='fa fa-list'></i> Contents</div>
  <a href='#main-menu' class='list-group-item level-1'>Main Menu</a>
  <a href='#game-over-menu' class='list-group-item level-1'>Game Over Menu</a>
  <a href='#displaying-the-menus' class='list-group-item level-1'>Displaying the Menus</a>
  <a href='#health-check-for-game-over' class='list-group-item level-2'>Health Check for Game Over</a>
  <a href='#congratulations' class='list-group-item level-1'>Congratulations</a>
</div>

    </div>
  </div>

  <div class="expander"></div>
</div>




</body>
</html>