<!DOCTYPE html>
<html lang="en">
<head>
<meta name="robots" content="noindex">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Camera and Viewport &#8212; Flame</title>
  <!-- Stylesheets -->
  <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b20cc3f5" />
  <link rel="stylesheet" type="text/css" href="_static/basic.css?v=eeb27264" />
  <link rel="stylesheet" type="text/css" href="_static/dart_domain.css" />
  <link rel="stylesheet" type="text/css" href="_static/flutter_app.css?v=6984c178" />
  <link rel="stylesheet" type="text/css" href="_static/package.css?v=7889e545" />
  <link rel="stylesheet" type="text/css" href="_static/yarn_lexer.css?v=932ca0ec" />
  <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
  <link rel="stylesheet" type="text/css" href="_static/flames.css?v=37920019" />
  <link rel="stylesheet" type="text/css" href="_static/copy-button.css?v=deecb4da" />
  <!-- Scripts -->
  <script src="_static/jquery.js?v=5d32c60e"></script>
  <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
  <script src="_static/documentation_options.js?v=5929fcd5"></script>
  <script src="_static/doctools.js?v=0b60eaae"></script>
  <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
  <script src="_static/flutter_app.js?v=3619378f"></script>
  <script src="_static/clipboard.min.js?v=a7894cd8"></script>
  <script src="_static/copybutton.js?v=f281be69"></script>
  <script src="_static/versions.js?v=58484017"></script>
  <script src="_static/menu-expand.js?v=8e297497"></script>
  <!--script src="searchindex.js" defer></script-->
  <!-- Links -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:ital,wght@0,400;0,700;1,400;1,700&display=swap">
  <link rel="preload" as="font" type="font/woff2" crossorigin="" href="_static/fontawesome/fa-brands-400.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin="" href="_static/fontawesome/fa-solid-900.woff2">
  <link rel="stylesheet" href="_static/fontawesome/all.min.css">
  <link rel="shortcut icon" href="_static/favicon.ico"/>
  <link rel="index" title="Index" href="genindex.html" />
  <link rel="search" title="Search" href="search.html" />
  <link rel="next" title="Gesture Input" href="gesture-input.html" />
  <link rel="prev" title="Effects" href="effects.html" />
</head>

<body data-spy="scroll" data-target="#toc-local" data-offset="80">

<div class="top-bar">
  <button id="menu-button" class="btn" title="Toggle menu"><i class="fa fa-bars"></i></button>
  <script type="text/javascript">
    jQuery(function(){
      $("#menu-button").click(function() {
        $(this).toggleClass("active");
        $(".sidebar-left-area").toggleClass("active");
      });

      $('div.nav-left li > a:not(:only-child)').wrap('<div class=submenu></div>');
      $('div.nav-left div.submenu').prepend('<a class=arrow>&nbsp;</a>');
      $('div.nav-left div.submenu > a.arrow')
        .click(function() {
          $(this.parentElement.parentElement).toggleClass('current');
        });

      // This function ensures that when navigating to internal targets within the page (such as
      // a section header), those targets will be visible to the user and not obscured by the menu
      // bar at the top of the page.
      function scrollToHashTarget() {
        if (location.hash !== location.oldHash) {
          window.scrollBy(0, -60);
          location.oldHash = location.hash;
        }
      }
      window.location.oldHash = '';
      window.addEventListener('hashchange', scrollToHashTarget);
      scrollToHashTarget();
    });
  </script>

  <a href="index.html" class="logo_image">
    <img src="_static/logo_flame.png">
  </a>  
  <div class="highlight-box" role="alert" style="display:none">
    <div>
      <div class="title">highlighted:</div>
      <div class="content" id="highlight-content"></div>
    </div>
    <button type="button" class="close" data-dismiss="alert" aria-label="Dismiss">×</button>
  </div>
  <div class="expander"></div>

  <div class="versions-placeholder"></div>
  <a href="https://discord.com/invite/pxrBmy4" id="discord-button" class="btn"
     title="Blue Fire Discord server">
    <i class="fab fa-discord"></i>
  </a>
  <a href="https://github.com/flame-engine/flame/" id="github-button" class="btn"
     title="GitHub repository">
    <i class="fab fa-github"></i>
  </a>
</div>

<div class="sidebar-left-area">
  <div class="sidebar-left-bg"></div>
  <div class="sidebar-left">
    <div class="searchbox" role="search">
      <form id="search-form" action="search.html" method="get">
        <i class="icon fa fa-search"></i>
        <input type="search" class="form-control" id="search-input" name="q"
               placeholder="Search the docs..." autocomplete="off" />
      </form>
    </div>
    <div class="nav-left" role="navigation" aria-label="Main">
      <p class="caption" role="heading"><span class="caption-text">Basic concepts</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="structure.html">File structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="game.html">FlameGame</a></li>
<li class="toctree-l1"><a class="reference internal" href="game.html#low-level-game-api">Low-level Game API</a></li>
<li class="toctree-l1"><a class="reference internal" href="game.html#gameloop">GameLoop</a></li>
<li class="toctree-l1"><a class="reference internal" href="game.html#pause-resuming-game-execution">Pause/Resuming game execution</a></li>
<li class="toctree-l1"><a class="reference internal" href="game.html#flutter-widgets-and-game-instances">Flutter Widgets and Game instances</a></li>
<li class="toctree-l1"><a class="reference internal" href="components.html">Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="platforms.html">Platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="collision_detection.html">Collision detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="effects.html">Effects</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Camera &amp; Viewport</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Inputs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="gesture-input.html">Gesture input</a></li>
<li class="toctree-l1"><a class="reference internal" href="keyboard-input.html">Keyboard input</a></li>
<li class="toctree-l1"><a class="reference internal" href="other-inputs.html">Other inputs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Audio</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="audio.html">General audio</a></li>
<li class="toctree-l1"><a class="reference internal" href="bgm.html">Background music</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Rendering</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="images.html">Images, sprites and animations</a></li>
<li class="toctree-l1"><a class="reference internal" href="text.html">Text rendering</a></li>
<li class="toctree-l1"><a class="reference internal" href="palette.html">Colors and palette</a></li>
<li class="toctree-l1"><a class="reference internal" href="particles.html">Particles</a></li>
<li class="toctree-l1"><a class="reference internal" href="layers.html">Layers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="util.html">Util</a></li>
<li class="toctree-l1"><a class="reference internal" href="widgets.html">Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="forge2d.html">Forge2D</a></li>
<li class="toctree-l1"><a class="reference internal" href="oxygen.html">Oxygen</a></li>
<li class="toctree-l1"><a class="reference internal" href="tiled.html">Tiled</a></li>
<li class="toctree-l1"><a class="reference internal" href="debug.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="splash_screen.html">Splash screen</a></li>
</ul>

    </div>
  </div>
</div>

<div class="main-area">
  <div class="document-wrapper">
    <div class="warning hidden" id="version-warning">
      <p><strong>Warning:</strong> you are currently viewing the docs for an older
      version <span class="version"></span> of Flame.</p>
      <p>Please <a href="/">click here</a> to go see the documentation for the latest
      released version.</p>
    </div>
    <div class="document" role="main">
      
  <section class="tex2jax_ignore mathjax_ignore" id="camera-and-viewport">
<h1>Camera and Viewport<a class="headerlink" href="#camera-and-viewport" title="Link to this heading">¶</a></h1>
<p>When rendering on Flutter, the regular coordinate space used are logical pixels. That means one
pixel for Flutter is already not necessarily one real pixel on the device, because of the <a class="reference external" href="https://api.flutter.dev/flutter/widgets/MediaQueryData/devicePixelRatio.html">device’s
pixel ratio</a>. When it
gets to the Flame level, we always consider the most fundamental level to be logical pixels, so all
the device specific complexity is abstracted away.</p>
<p>However, that still leaves you with arbitrarily shaped and sized screens. And it’s very likely that
your game has some sort of game world with an intrinsic coordinate system that does not map to
screen coordinates. Flame adds two distinct concepts to help transform coordinate spaces. For the
former, we have the Viewport class. And for the later, we have the Camera class.</p>
<section id="viewport">
<h2>Viewport<a class="headerlink" href="#viewport" title="Link to this heading">¶</a></h2>
<p>The Viewport is an attempt to unify multiple screen (or, rather, game widget) sizes into a single
configuration for your game by translating and resizing the canvas.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Viewport</span></code> interface has multiple implementations and can be used from scratch on your <code class="docutils literal notranslate"><span class="pre">Game</span></code>
or, if you are using <code class="docutils literal notranslate"><span class="pre">FlameGame</span></code> instead, it’s already built-in (with a default no-op viewport).</p>
<p>These are the viewports available to pick from (or you can implement the interface yourself to suit
your needs):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DefaultViewport</span></code>: this is the no-op viewport that is associated by default with any <code class="docutils literal notranslate"><span class="pre">FlameGame</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FixedResolutionViewport</span></code>: this viewport transforms your Canvas so that, from the game
perspective, the dimensions are always set to a fixed pre-defined value. This means it will scale
the game as much as possible and add black bars if needed.</p></li>
</ul>
<p>When using <code class="docutils literal notranslate"><span class="pre">FlameGame</span></code>, the operations performed by the viewport are done automatically to every
render operation, and the <code class="docutils literal notranslate"><span class="pre">size</span></code> property in the game, instead of the logical widget size, becomes
the size as seen through the viewport together with the zoom of the camera. If for some reason you
need to access the original real logical pixel size, you can use <code class="docutils literal notranslate"><span class="pre">canvasSize</span></code>. For a more in depth
description on what each <code class="docutils literal notranslate"><span class="pre">Viewport</span></code> does and how it operates, check the documentation on its class.</p>
</section>
<section id="camera">
<h2>Camera<a class="headerlink" href="#camera" title="Link to this heading">¶</a></h2>
<p>Unlike the <code class="docutils literal notranslate"><span class="pre">Viewport</span></code>, the <code class="docutils literal notranslate"><span class="pre">Camera</span></code> is a more dynamic <code class="docutils literal notranslate"><span class="pre">Canvas</span></code> transformation that is normally
dependent on:</p>
<ul class="simple">
<li><p>World coordinates that do not match screen coordinates 1:1.</p></li>
<li><p>Centering or following the player around the game world (if the world is bigger than the screen).</p></li>
<li><p>User controlled zooming in and out.</p></li>
</ul>
<p>There is only one Camera implementation but it allows for many different configurations. Again, you
can use it standalone on your <code class="docutils literal notranslate"><span class="pre">Game</span></code> but it’s already included and wired into <code class="docutils literal notranslate"><span class="pre">FlameGame</span></code>.</p>
<p>One important thing to note about the Camera is that since (unlike the Viewport) it’s intended to be
dynamic, most camera movements won’t immediately happen. Instead, the camera has a configurable
speed and is updated on the game loop. If you want to immediately move your camera (like on your
first camera setup at game start) you can use the <code class="docutils literal notranslate"><span class="pre">snap</span></code> function. Calling snap during the game can
lead to jarring or unnatural camera movements though, so avoid that unless desired (say for a map
transition, for example). Carefully check the docs for each method for more details about how it
affects the camera movement.</p>
<p>Another important note is that the camera is applied after the viewport, and only to non-HUD
components. So screen size here is considering the effective size after Viewport transformations.</p>
<p>There are two types of transformations that the Camera can apply to the Canvas. The first and most
complex one is translation. That can be applied by several factors:</p>
<ul class="simple">
<li><p>nothing: by default the camera won’t apply any transformation, so it’s optional to use it.</p></li>
<li><p>relative offset: you can configure this to decide “where the center of the camera should be on
the screen”. By default it’s the top left corner, meaning that the centered coordinate or object
will always be on the top left corner of the screen. You can smoothly change the relative offset
during gameplay (that can be used to apply a dialogue or item pickup temporary camera transition
for example).</p></li>
<li><p>moveTo: if you want to ad-hoc move your camera you can use this method; it will smoothly
transition the camera to a new position, ignoring follows but respecting relative offset and
world bounds. This can be reset by <code class="docutils literal notranslate"><span class="pre">resetMovement</span></code> if used in conjunction to follow so that the
followed object starts being considered again.</p></li>
<li><p>follow: you can use this method so that your camera continuously “follow” an object (for example,
a <code class="docutils literal notranslate"><span class="pre">PositionComponent</span></code>). This is not smooth because the movement of the followed object itself is
assumed to already be smooth (i.e. if your character teleport the camera will also immediately
teleport).</p></li>
<li><p>world bounds: when using follow, you can optionally define the bounds of the world. If that is
done, the camera will stop following/moving so that out-of-bounds areas are not shown (as long as
the world is bigger than the screen).</p></li>
</ul>
<p>Finally the second transformation that the camera applies is scaling. That allows for dynamic
zooming, and it’s controlled by the <code class="docutils literal notranslate"><span class="pre">zoom</span></code> field. There is no zoom speed, that must be controlled by
you when changing. The <code class="docutils literal notranslate"><span class="pre">zoom</span></code> variable is immediately applied.</p>
<p>When dealing with input events, it is imperative to convert screen coordinates to world coordinates
(or, for some reasons, you might want to do the reverse). The Camera provides two functions,
<code class="docutils literal notranslate"><span class="pre">screenToWorld</span></code> and <code class="docutils literal notranslate"><span class="pre">worldToScreen</span></code> to easily convert between these coordinate spaces.</p>
<section id="using-the-camera-with-the-game-class">
<h3>Using the camera with the Game class<a class="headerlink" href="#using-the-camera-with-the-game-class" title="Link to this heading">¶</a></h3>
<p>If you are not using <code class="docutils literal notranslate"><span class="pre">FlameGame</span></code>, but instead are using the <code class="docutils literal notranslate"><span class="pre">Game</span></code> class, then you need to manage
calling certain camera methods yourself. Let’s say we have the following game structure, and we
want to add the camera functionality:</p>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">YourGame</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Game</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">Camera</span><span class="o">?</span><span class="w"> </span><span class="n">camera</span><span class="p">;</span>

<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">onLoad</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">render</span><span class="p">(</span><span class="n">Canvas</span><span class="w"> </span><span class="n">canvas</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">update</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">dt</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We first create a new camera instance on load and assign our game as the reference:</p>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="c1">// ...</span>
<span class="w">  </span>
<span class="w">  </span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">onLoad</span><span class="p">()</span><span class="w"> </span><span class="kd">async</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">camera</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Camera</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// This is required for the camera to work.</span>
<span class="w">    </span><span class="n">camera</span><span class="o">?</span><span class="p">.</span><span class="n">gameRef</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Not required but recommend to set it now or when you set the follow target.</span>
<span class="w">    </span><span class="n">camera</span><span class="o">?</span><span class="p">.</span><span class="n">worldBounds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yourWorldBounds</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Rest of your on load code.</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// ...</span>
</pre></div>
</div>
<p>The camera can also be made aware of which position to follow, this is an optional feature as you
can also use the camare for just moving,snapping or shaking.</p>
<p>To do this the <code class="docutils literal notranslate"><span class="pre">Camera</span></code> class provides multiple methods for it but let’s showcase the simplest one
and that is the <code class="docutils literal notranslate"><span class="pre">followVector2</span></code>:</p>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="c1">// Somewhere in your code.</span>

<span class="w">  </span><span class="n">camera</span><span class="o">?</span><span class="p">.</span><span class="n">followVector2</span><span class="p">(</span>
<span class="w">    </span><span class="n">yourPositionToFollow</span><span class="p">,</span>
<span class="w">    </span><span class="nl">worldBounds:</span><span class="w"> </span><span class="n">yourWorldBounds</span><span class="p">,</span><span class="w"> </span><span class="c1">// Optional to pass, it will overwrite the previous bounds.</span>
<span class="w">  </span><span class="p">);</span>
</pre></div>
</div>
<p>Now that the camera is created and it is aware of both the world bounds and the position it should
follow, it can be used to translate the canvas in the render method:</p>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="c1">// ...</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">render</span><span class="p">(</span><span class="n">Canvas</span><span class="w"> </span><span class="n">canvas</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">camera</span><span class="o">?</span><span class="p">.</span><span class="n">apply</span><span class="p">(</span><span class="n">canvas</span><span class="p">);</span><span class="w"> </span><span class="c1">// This will apply the camera transformation.</span>

<span class="w">    </span><span class="c1">// Rest of your rendering code.</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// ...</span>
</pre></div>
</div>
<p>The only thing left to do is to call the <code class="docutils literal notranslate"><span class="pre">update</span></code> method on the <code class="docutils literal notranslate"><span class="pre">Camera</span></code> so it can smoothly follow
your given position:</p>
<div class="highlight-dart notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="c1">// ...</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">update</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">dt</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">camera</span><span class="o">?</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">dt</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Rest of your update code.</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// ...</span>
</pre></div>
</div>
</section>
</section>
</section>


    </div>
    <div class="copyright">
      The content on this page is licensed under the <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 License</a>,
      and code samples under the <a href="https://raw.githubusercontent.com/flame-engine/flame/main/LICENSE">MIT License</a>.
    </div>
    <div class="prev-next-area">
      <a class="left-prev" id="prev-link" href="effects.html" title="previous page">
        <i class="fa fa-angle-left"></i>
        <div class="prev-next-info">
          <p class="prev-next-subtitle">Previous:</p>
          <p class="prev-next-title">Effects</p>
        </div>
      </a>
      <div class='expander'></div>
      <a class="right-next" id="next-link" href="gesture-input.html" title="next page">
        <div class="prev-next-info">
          <p class="prev-next-subtitle">Next:</p>
          <p class="prev-next-title">Gesture Input</p>
        </div>
        <i class="fa fa-angle-right"></i>
      </a>
    </div>
  </div>

  <div class="sidebar-right">
    
    <div class="nav-right" role="navigation" aria-label="table of contents">
      <div id='toc-local' class='list-group'>
 <div class='header'><i class='fa fa-list'></i> Contents</div>
  <a href='#viewport' class='list-group-item level-1'>Viewport</a>
  <a href='#camera' class='list-group-item level-1'>Camera</a>
  <a href='#using-the-camera-with-the-game-class' class='list-group-item level-2'>Using the camera with the Game class</a>
</div>

    </div>
  </div>

  <div class="expander"></div>
</div>




</body>
</html>